<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Natalia Andriychuk">
<meta name="dcterms.date" content="2023-03-17">

<title>11&nbsp; 테스트 – Pharma Hands-on Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./MiniProject13_ko.html" rel="next">
<link href="./MiniProject11_ko.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-cd63b520c5e060288b5099369e8bcbf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./MiniProject12_ko.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">테스트</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pharma Hands-on Exercises</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">초록</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject1_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">데이터셋 읽기 및 탐색</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject2_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">2 - 연속형 및 범주형 데이터 요약</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject3_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">3 - 그룹화된 요약 통계 생성</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject4_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">요약 테이블 데이터 생성</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject5_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">{ggplot2} 시작하기</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject6_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">{ggplot2} 확장 패키지</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject7_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">7 - 함수 작성 시작하기</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject8_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">반복을 통한 함수 적용</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject10_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">디버깅</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject11_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">깔끔한 평가</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject12_ko.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">테스트</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject13_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">코드 스타일</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject14_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">R 스니펫</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#소개" id="toc-소개" class="nav-link active" data-scroll-target="#소개"><span class="header-section-number">11.1</span> 소개</a></li>
  <li><a href="#테스트의-이점" id="toc-테스트의-이점" class="nav-link" data-scroll-target="#테스트의-이점"><span class="header-section-number">11.2</span> 테스트의 이점</a></li>
  <li><a href="#테스트-가능한-코드-작성" id="toc-테스트-가능한-코드-작성" class="nav-link" data-scroll-target="#테스트-가능한-코드-작성"><span class="header-section-number">11.3</span> 테스트 가능한 코드 작성</a></li>
  <li><a href="#testthat을-사용한-자동화된-테스트" id="toc-testthat을-사용한-자동화된-테스트" class="nav-link" data-scroll-target="#testthat을-사용한-자동화된-테스트"><span class="header-section-number">11.4</span> {testthat}을 사용한 자동화된 테스트</a></li>
  <li><a href="#기대치" id="toc-기대치" class="nav-link" data-scroll-target="#기대치"><span class="header-section-number">11.5</span> 기대치</a></li>
  <li><a href="#테스트-가능한-코드-작성---예제" id="toc-테스트-가능한-코드-작성---예제" class="nav-link" data-scroll-target="#테스트-가능한-코드-작성---예제"><span class="header-section-number">11.6</span> 테스트 가능한 코드 작성 - 예제</a></li>
  <li><a href="#테스트-작성" id="toc-테스트-작성" class="nav-link" data-scroll-target="#테스트-작성"><span class="header-section-number">11.7</span> 테스트 작성</a></li>
  <li><a href="#테스트-구성-및-실행" id="toc-테스트-구성-및-실행" class="nav-link" data-scroll-target="#테스트-구성-및-실행"><span class="header-section-number">11.8</span> 테스트 구성 및 실행</a></li>
  <li><a href="#챌린지" id="toc-챌린지" class="nav-link" data-scroll-target="#챌린지"><span class="header-section-number">11.9</span> 챌린지</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">테스트</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Natalia Andriychuk </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 17, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><code>{testthat}</code>은 이 프로젝트에서 사용할 새로운 패키지입니다. 이 연습을 시작하기 전에 설치하십시오.</p>
<section id="소개" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="소개"><span class="header-section-number">11.1</span> 소개</h2>
<p>이 미니 프로젝트에서는 R에서 코드를 테스트하는 방법을 살펴봅니다. 코드를 테스트하는 것은 고통스럽고 지루할 수 있지만 코드의 품질을 크게 향상시킵니다. 코드가 원하는 대로 작동하는지 확인하는 동시에 테스트 설명서를 제공합니다.</p>
</section>
<section id="테스트의-이점" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="테스트의-이점"><span class="header-section-number">11.2</span> 테스트의 이점</h2>
<p>R에서 함수를 개발하는 동안 프로그래머는 일반적으로 비공식적인 테스트를 수행합니다. 함수를 작성한 후에는 데이터 세트에서 실행하고 결과를 예상과 비교하여 콘솔에서 테스트할 가능성이 높습니다. 이 접근 방식은 코드를 개발하는 동안 비공식적인 테스트에 좋지만 한두 달 후에 코드에 새로운 기능을 추가해야 하고 수행한 테스트 기록이 없는 경우 문제가 됩니다. 이렇게 하면 작동하던 코드를 쉽게 깨뜨릴 수 있습니다.</p>
<p>보다 공식적인 QC 프로세스는 어떻습니까? R 코드를 작성한 후에는 동료에게 생성한 함수를 독립적으로 QC하여 몇 가지 예제로 테스트하여 올바른지 확인하도록 요청할 수 있습니다. 이 접근 방식은 유효하며 작업을 완료하지만 몇 가지 질문이 있습니다:</p>
<ul>
<li><p>인간 검토자가 없는 경우 코드가 예상대로 작동하는지 어떻게 확인하시겠습니까?</p></li>
<li><p>나중에 코드의 다른 부분에 대한 변경 사항이 이미 QC 및 테스트된 코드에 영향을 미치지 않았는지 어떻게 확인하시겠습니까?</p></li>
<li><p>검토자는 테스트를 어떻게 문서화해야 합니까?</p></li>
</ul>
<p>이러한 모든 질문은 <strong>자동화된 테스트</strong>(자동화된 <strong>단위 테스트</strong>라고도 함)로 해결할 수 있습니다. 단위 테스트를 통해 코드 단위의 올바른 동작을 확인할 수 있으며, 이는 R의 맥락에서 함수의 올바른 동작으로 변환됩니다.</p>
<p>자동화된 단위 테스트의 장점:</p>
<ul>
<li><p>시간과 노력을 절약하고 디버깅에 도움이 됩니다.</p></li>
<li><p>인간 검토자가 없는 경우 코드가 예상대로 작동하는지 확인하는 데 도움이 됩니다.</p></li>
<li><p>코드의 일부가 변경될 때마다 테스트를 다시 실행하여 새 코드가 이전에 설정된 기능 및 기대치에 영향을 미치지 않았는지 확인할 수 있습니다.</p></li>
<li><p>테스트 자체는 코드에 대한 설명서를 제공합니다.</p></li>
</ul>
<p>… <strong>그리고 테스트 가능한 코드를 작성하도록 강요하여</strong> 전체 코드 설계를 개선합니다.</p>
</section>
<section id="테스트-가능한-코드-작성" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="테스트-가능한-코드-작성"><span class="header-section-number">11.3</span> 테스트 가능한 코드 작성</h2>
<p>테스트를 작성하는 데 어려움을 겪고 있다면 문제가 함수 설계에 있을 수 있다는 힌트로 받아들이십시오. <strong>좋은 함수는 수행하는 하나의 주요 작업이 있으며</strong> 그런 다음 테스트됩니다.</p>
<p>MiniProject7에서는 좋은 함수는 읽고, 검토하고, 개선하기 쉬워야 한다고 논의했습니다. <strong>수행하는 하나의 주요 작업이 있는</strong> 함수를 테스트하고 디버깅하는 것도 더 쉽습니다. MiniProject7의 <em><code>6. 검토 및 리팩토링. 자주.</code></em> 섹션에서 우리 함수가 데이터 위치 경로를 가져와 SAS 데이터셋을 읽는 것부터 테이블 내용을 생성하는 것까지 모든 것을 수행했던 것을 기억하십니까? 이러한 함수는 데이터를 읽고 정리하는 두 가지 작업을 수행하기 때문에 테스트하기가 더 어려울 것입니다. 해당 연습에서는 함수 외부에서 읽은 데이터를 사용하여 요약된 개수만 생성하도록 함수를 업데이트한 후 상황을 단순화할 수 있었습니다. 이렇게 하면 함수의 속도가 향상되고 테스트에 더 적합해졌습니다.</p>
</section>
<section id="testthat을-사용한-자동화된-테스트" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="testthat을-사용한-자동화된-테스트"><span class="header-section-number">11.4</span> {testthat}을 사용한 자동화된 테스트</h2>
<p><strong>{testthat}</strong>은 R에서 가장 인기 있는 단위 테스트 패키지이며 주로 R 패키지를 테스트하는 데 사용되지만 패키지로 래핑하고 싶지 않더라도 자체 코드를 개발할 때 깔끔한 기능을 사용할 수 있습니다.</p>
</section>
<section id="기대치" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="기대치"><span class="header-section-number">11.5</span> 기대치</h2>
<p><strong>기대치</strong>는 가장 세분화된 테스트 수준이며 함수에서 반환된 값이 우리가 얻어야 하는 값과 일치하는지 확인할 수 있습니다. 계산의 예상 결과를 설명합니다. 올바른 값과 올바른 클래스가 있습니까? 그래야 할 때 오류가 발생합니까? 기대치는 콘솔에서 결과의 시각적 확인을 자동화합니다. 기대치는 <code>expect_</code>로 시작하는 함수입니다.</p>
<p>개발자는 유효한 입력, 유효하지 않은 입력, 오류, 예외, 이벤트 및 깨질 가능성이 있는 모든 것을 테스트해야 합니다.</p>
<p>{testthat} 패키지에는 <a href="https://testthat.r-lib.org/reference/index.html">많은 기대치 함수</a>가 있습니다. 그들이 답하는 질문의 예는 다음과 같습니다:</p>
<ul>
<li><p>코드가 예상 값을 반환합니까? <a href="https://testthat.r-lib.org/reference/equality-expectations.html"><code>expect_equal()</code></a> <a href="https://testthat.r-lib.org/reference/equality-expectations.html"><code>expect_identical()</code></a></p></li>
<li><p>코드가 지정된 길이의 벡터를 반환합니까? <a href="https://testthat.r-lib.org/reference/expect_length.html">expect_length()</a></p></li>
<li><p>코드가 예상 값보다 크거나 작은 숫자를 반환합니까? <a href="https://testthat.r-lib.org/reference/comparison-expectations.html"><code>expect_lt()</code></a> <a href="https://testthat.r-lib.org/reference/comparison-expectations.html"><code>expect_lte()</code></a> <a href="https://testthat.r-lib.org/reference/comparison-expectations.html"><code>expect_gt()</code></a> <a href="https://testthat.r-lib.org/reference/comparison-expectations.html">expect_gte()</a></p></li>
<li><p>코드가 <code>TRUE</code> 또는 <code>FALSE</code>를 반환합니까? <a href="https://testthat.r-lib.org/reference/logical-expectations.html"><code>expect_true()</code></a> <a href="https://testthat.r-lib.org/reference/logical-expectations.html"><code>expect_false()</code></a></p></li>
<li><p>코드가 오류, 경고, 메시지 또는 기타 조건을 발생시킵니까? <a href="https://testthat.r-lib.org/reference/expect_error.html"><code>expect_error()</code></a> <a href="https://testthat.r-lib.org/reference/expect_error.html"><code>expect_warning()</code></a> <a href="https://testthat.r-lib.org/reference/expect_error.html"><code>expect_message()</code></a> <code>expect_condition()</code></p></li>
</ul>
<p>…그리고 훨씬 더 많습니다!</p>
<p>테스트는 <strong>매우 광범위한 주제</strong>이며 이 미니 프로젝트에서 모든 것을 다룰 수는 없습니다. 주요 목표는 테스트의 아이디어를 파악하고 {testthat} 패키지에 익숙해지는 것입니다.</p>
</section>
<section id="테스트-가능한-코드-작성---예제" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="테스트-가능한-코드-작성---예제"><span class="header-section-number">11.6</span> 테스트 가능한 코드 작성 - 예제</h2>
<p>이제 테스트의 이점을 논의하고 {testthat} 패키지에 대해 배웠으므로 오늘 작업할 몇 가지 함수를 살펴보겠습니다. 테스트할 첫 번째 함수는 <code>wrangle_data()</code> 함수입니다. 하나의 인수(데이터)를 사용합니다. 그런 다음 데이터를 로드, 필터링 및 부분집합으로 만들고 <code>adsl_data</code> 객체를 반환합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(testthat)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle_data 함수 생성</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>wrangle_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  adsl_data <span class="ot">&lt;-</span> adsl_data <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SAFFL <span class="sc">==</span> <span class="st">"Y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">"STUDYID"</span>, <span class="st">"USUBJID"</span>, <span class="st">"SEX"</span>, <span class="st">"TRT01A"</span>, <span class="st">"TRT01AN"</span>, <span class="st">"SAFFL"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(adsl_data)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이제 미니 프로젝트 7에서 작업했던 <code>adsl_counts()</code> 함수(단순화된 버전)를 살펴보겠습니다. 이 함수는 <code>wrangle_data()</code> 함수의 <strong>출력</strong>을 가져와 <strong>입력</strong>으로 사용합니다. <code>adsl_counts</code> 함수가 몇 가지 작업을 수행한다는 점에 유의하십시오:</p>
<ul>
<li><p>먼저 치료 그룹별 발생 횟수 총계를 담는 <code>Big_N_cnt</code> 객체를 만듭니다.</p></li>
<li><p>그런 다음 치료 그룹 및 성별별 발생 횟수 총계를 담는 <code>small_n_cnt</code> 객체를 만듭니다.</p></li>
<li><p>그런 다음 <code>Big_N_cnt</code> 및 <code>small_n_cnt</code>를 활용하여 이 두 객체를 사용하여 백분율을 계산하는 <code>adsl_mrg_cnt</code> tibble을 만듭니다.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>adsl_counts <span class="ot">&lt;-</span> <span class="cf">function</span>(adsl_data) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  Big_N_cnt <span class="ot">&lt;-</span>  adsl_data   <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>( TRT01AN, TRT01A  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"N"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  Big_N_cnt</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  small_n_cnt <span class="ot">&lt;-</span>  adsl_data  <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>( TRT01AN, TRT01A,  SEX ) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"n"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  small_n_cnt</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  adsl_mrg_cnt <span class="ot">&lt;-</span> small_n_cnt <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(Big_N_cnt, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"TRT01A"</span>, <span class="st">"TRT01AN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">perc =</span> <span class="fu">round</span>((n<span class="sc">/</span>N)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(TRT01A, SEX, perc)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  adsl_mrg_cnt</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이러한 함수는 함수 내부에 종속성이 있기 때문에 디버깅하고 테스트하기가 더 어려울 수 있습니다. 예를 들어 <code>small_n_cnt</code> 또는 <code>Big_N_cnt</code>가 계산되지 않거나 예기치 않은 결과를 생성하면 <code>adsl_mrg_cnt</code> 단계가 실패합니다.</p>
<p>이를 염두에 두고 큰 함수를 세 개의 작은 함수로 나누어 각각을 개별적으로 테스트할 수 있도록 하겠습니다. 이러한 함수를 <code>calculate_Big_N_cnt</code>, <code>calculate_small_n_cnt</code> 및 <code>adsl_counts</code>라고 부르겠습니다.</p>
<p>먼저 <code>adsl_data</code> 인수를 사용하고 <code>Big_N_cnt</code>를 <code>반환</code>하는 <code>calculate_Big_N_cnt</code> 함수를 만듭니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>calculate_Big_N_cnt <span class="ot">&lt;-</span> <span class="cf">function</span>(adsl_data) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  Big_N_cnt <span class="ot">&lt;-</span>  adsl_data   <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>( TRT01AN, TRT01A ) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"N"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Big_N_cnt)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이제 아래 코드 줄을 <code>adsl_data</code> 인수를 사용하는 <code>calculate_small_n_cnt</code> 함수로 바꾸는 코드를 추가하십시오. <code>small_n_cnt</code>를 <code>return()</code>하는 것을 잊지 마십시오.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>calculate_small_n_cnt <span class="ot">&lt;-</span> <span class="cf">function</span>(adsl_data) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  small_n_cnt <span class="ot">&lt;-</span> adsl_data <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(TRT01AN, TRT01A, SEX) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"n"</span>, <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="co"># 좋은 습관을 위해 .groups = 'drop' 추가</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(small_n_cnt)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이제 아래 코드를 <code>adsl_counts</code> 함수로 변환해 보겠습니다. 이 함수는 위 두 함수의 출력을 인수로 사용한다는 것을 기억하십시오.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>adsl_counts <span class="ot">&lt;-</span> <span class="cf">function</span>(small_n_cnt, Big_N_cnt) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  adsl_mrg_cnt <span class="ot">&lt;-</span> small_n_cnt <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(Big_N_cnt, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"TRT01A"</span>, <span class="st">"TRT01AN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">perc =</span> <span class="fu">round</span>((n<span class="sc">/</span>N)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(TRT01A, SEX, perc)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(adsl_mrg_cnt)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="테스트-작성" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="테스트-작성"><span class="header-section-number">11.7</span> 테스트 작성</h2>
<p>이제 함수를 테스트해 보겠습니다! 위에서 설명한 <code>expect_</code> 함수를 사용하여 테스트를 지원할 것입니다. 함수의 입력, 출력 데이터를 테스트하고 함수가 수행하는 계산이 올바른지 확인할 것입니다.</p>
<p>먼저 <code>wrangle_data()</code> 함수에 대한 몇 가지 테스트를 작성해 보겠습니다. 테스트 데이터로는 PHUSE 조직에서 게시한 CDISC ADaM 데이터를 사용할 것입니다(<code>adsl_data</code>는 이미 환경에 로드되어 있습니다). 경험상 프로덕션 코드를 실행하는 데 사용하는 데이터와 다른 데이터를 테스트에 사용하는 것이 좋습니다. 데이터도 잘 제어되어야 합니다. 이 경우 ADSL 데이터 형식은 신뢰할 수 있는 출처에서 온 표준화된 형식입니다. <code>wrangle_data()</code> 함수는 몇 가지 변환(데이터를 필터링하고 부분집합으로 만듦)을 수행하며 예기치 않은 <strong>출력</strong>을 테스트하려고 합니다.</p>
<p>특정 테스트에서는 특정 기능을 테스트하기 위해 추가 테스트 데이터를 만들어야 하지만, 거기에 도달하면 이에 대해 논의할 것입니다.</p>
<p>데이터를 살펴보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PHUSE 데이터 읽기</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>phuse_data <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"./data/adsl.xpt"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(phuse_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       STUDYID     USUBJID SUBJID SITEID SITEGR1                  ARM
1 CDISCPILOT01 01-701-1015   1015    701     701              Placebo
2 CDISCPILOT01 01-701-1023   1023    701     701              Placebo
3 CDISCPILOT01 01-701-1028   1028    701     701 Xanomeline High Dose
4 CDISCPILOT01 01-701-1033   1033    701     701  Xanomeline Low Dose
5 CDISCPILOT01 01-701-1034   1034    701     701 Xanomeline High Dose
6 CDISCPILOT01 01-701-1047   1047    701     701              Placebo
                TRT01P TRT01PN               TRT01A TRT01AN     TRTSDT
1              Placebo       0              Placebo       0 2014-01-02
2              Placebo       0              Placebo       0 2012-08-05
3 Xanomeline High Dose      81 Xanomeline High Dose      81 2013-07-19
4  Xanomeline Low Dose      54  Xanomeline Low Dose      54 2014-03-18
5 Xanomeline High Dose      81 Xanomeline High Dose      81 2014-07-01
6              Placebo       0              Placebo       0 2013-02-12
      TRTEDT TRTDUR AVGDD CUMDOSE AGE AGEGR1 AGEGR1N  AGEU  RACE RACEN SEX
1 2014-07-02    182   0.0       0  63    &lt;65       1 YEARS WHITE     1   F
2 2012-09-01     28   0.0       0  64    &lt;65       1 YEARS WHITE     1   M
3 2014-01-14    180  77.7   13986  71  65-80       2 YEARS WHITE     1   M
4 2014-03-31     14  54.0     756  74  65-80       2 YEARS WHITE     1   M
5 2014-12-30    183  76.9   14067  77  65-80       2 YEARS WHITE     1   F
6 2013-03-09     26   0.0       0  85    &gt;80       3 YEARS WHITE     1   F
                  ETHNIC SAFFL ITTFL EFFFL COMP8FL COMP16FL COMP24FL DISCONFL
1     HISPANIC OR LATINO     Y     Y     Y       Y        Y        Y         
2     HISPANIC OR LATINO     Y     Y     Y       N        N        N        Y
3 NOT HISPANIC OR LATINO     Y     Y     Y       Y        Y        Y         
4 NOT HISPANIC OR LATINO     Y     Y     Y       N        N        N        Y
5 NOT HISPANIC OR LATINO     Y     Y     Y       Y        Y        Y         
6 NOT HISPANIC OR LATINO     Y     Y     Y       N        N        N        Y
  DSRAEFL DTHFL BMIBL BMIBLGR1 HEIGHTBL WEIGHTBL EDUCLVL   DISONSDT DURDIS
1                25.1   25-&lt;30    147.3     54.4      16 2010-04-30   43.9
2       Y        30.4     &gt;=30    162.6     80.3      14 2006-03-11   76.4
3                31.4     &gt;=30    177.8     99.3      16 2009-12-16   42.8
4                28.8   25-&lt;30    175.3     88.5      12 2009-08-02   55.3
5                26.1   25-&lt;30    154.9     62.6       9 2011-09-29   32.9
6       Y        30.4     &gt;=30    148.6     67.1       8 2009-07-26   42.0
  DURDSGR1   VISIT1DT    RFSTDTC    RFENDTC VISNUMEN     RFENDT
1     &gt;=12 2013-12-26 2014-01-02 2014-07-02       12 2014-07-02
2     &gt;=12 2012-07-22 2012-08-05 2012-09-02        5 2012-09-02
3     &gt;=12 2013-07-11 2013-07-19 2014-01-14       12 2014-01-14
4     &gt;=12 2014-03-10 2014-03-18 2014-04-14        5 2014-04-14
5     &gt;=12 2014-06-24 2014-07-01 2014-12-30       12 2014-12-30
6     &gt;=12 2013-01-22 2013-02-12 2013-03-29        6 2013-03-29
                      DCDECOD         DCREASCD MMSETOT
1                   COMPLETED        Completed      23
2               ADVERSE EVENT    Adverse Event      23
3                   COMPLETED        Completed      23
4 STUDY TERMINATED BY SPONSOR Sponsor Decision      23
5                   COMPLETED        Completed      21
6               ADVERSE EVENT    Adverse Event      23</code></pre>
</div>
</div>
<p>이제 데이터에 적용했을 때 함수의 출력을 살펴보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrange 데이터 함수 생성</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>wrangle_data <span class="ot">&lt;-</span> <span class="cf">function</span>(adsl_data) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  adsl_data <span class="ot">&lt;-</span> adsl_data <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SAFFL <span class="sc">==</span> <span class="st">"Y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">"STUDYID"</span>, <span class="st">"USUBJID"</span>, <span class="st">"SEX"</span>, <span class="st">"TRT01A"</span>, <span class="st">"TRT01AN"</span>, <span class="st">"SAFFL"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(adsl_data)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>adsl_data <span class="ot">&lt;-</span> <span class="fu">wrangle_data</span>(phuse_data) </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>adsl_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         STUDYID     USUBJID SEX               TRT01A TRT01AN SAFFL
1   CDISCPILOT01 01-701-1015   F              Placebo       0     Y
2   CDISCPILOT01 01-701-1023   M              Placebo       0     Y
3   CDISCPILOT01 01-701-1028   M Xanomeline High Dose      81     Y
4   CDISCPILOT01 01-701-1033   M  Xanomeline Low Dose      54     Y
5   CDISCPILOT01 01-701-1034   F Xanomeline High Dose      81     Y
6   CDISCPILOT01 01-701-1047   F              Placebo       0     Y
7   CDISCPILOT01 01-701-1097   M  Xanomeline Low Dose      54     Y
8   CDISCPILOT01 01-701-1111   F  Xanomeline Low Dose      54     Y
9   CDISCPILOT01 01-701-1115   M  Xanomeline Low Dose      54     Y
10  CDISCPILOT01 01-701-1118   M              Placebo       0     Y
11  CDISCPILOT01 01-701-1130   M              Placebo       0     Y
12  CDISCPILOT01 01-701-1133   F Xanomeline High Dose      81     Y
13  CDISCPILOT01 01-701-1146   F Xanomeline High Dose      81     Y
14  CDISCPILOT01 01-701-1148   M Xanomeline High Dose      81     Y
15  CDISCPILOT01 01-701-1153   F              Placebo       0     Y
16  CDISCPILOT01 01-701-1180   M Xanomeline High Dose      81     Y
17  CDISCPILOT01 01-701-1181   F Xanomeline High Dose      81     Y
18  CDISCPILOT01 01-701-1188   M  Xanomeline Low Dose      54     Y
19  CDISCPILOT01 01-701-1192   F  Xanomeline Low Dose      54     Y
20  CDISCPILOT01 01-701-1203   F              Placebo       0     Y
21  CDISCPILOT01 01-701-1211   F  Xanomeline Low Dose      54     Y
22  CDISCPILOT01 01-701-1234   M              Placebo       0     Y
23  CDISCPILOT01 01-701-1239   M Xanomeline High Dose      81     Y
24  CDISCPILOT01 01-701-1275   M Xanomeline High Dose      81     Y
25  CDISCPILOT01 01-701-1287   F Xanomeline High Dose      81     Y
26  CDISCPILOT01 01-701-1294   M  Xanomeline Low Dose      54     Y
27  CDISCPILOT01 01-701-1302   M Xanomeline High Dose      81     Y
28  CDISCPILOT01 01-701-1317   M  Xanomeline Low Dose      54     Y
29  CDISCPILOT01 01-701-1324   M  Xanomeline Low Dose      54     Y
30  CDISCPILOT01 01-701-1341   M  Xanomeline Low Dose      54     Y
31  CDISCPILOT01 01-701-1345   F              Placebo       0     Y
32  CDISCPILOT01 01-701-1360   M Xanomeline High Dose      81     Y
33  CDISCPILOT01 01-701-1363   F              Placebo       0     Y
34  CDISCPILOT01 01-701-1383   F Xanomeline High Dose      81     Y
35  CDISCPILOT01 01-701-1387   F              Placebo       0     Y
36  CDISCPILOT01 01-701-1392   M              Placebo       0     Y
37  CDISCPILOT01 01-701-1415   M              Placebo       0     Y
38  CDISCPILOT01 01-701-1429   F  Xanomeline Low Dose      54     Y
39  CDISCPILOT01 01-701-1440   M              Placebo       0     Y
40  CDISCPILOT01 01-701-1442   F  Xanomeline Low Dose      54     Y
41  CDISCPILOT01 01-701-1444   M Xanomeline High Dose      81     Y
42  CDISCPILOT01 01-702-1082   F  Xanomeline Low Dose      54     Y
43  CDISCPILOT01 01-703-1042   M              Placebo       0     Y
44  CDISCPILOT01 01-703-1076   M Xanomeline High Dose      81     Y
45  CDISCPILOT01 01-703-1086   M  Xanomeline Low Dose      54     Y
46  CDISCPILOT01 01-703-1096   F              Placebo       0     Y
47  CDISCPILOT01 01-703-1100   F              Placebo       0     Y
48  CDISCPILOT01 01-703-1119   F  Xanomeline Low Dose      54     Y
49  CDISCPILOT01 01-703-1175   M              Placebo       0     Y
50  CDISCPILOT01 01-703-1182   M  Xanomeline Low Dose      54     Y
51  CDISCPILOT01 01-703-1197   F  Xanomeline Low Dose      54     Y
52  CDISCPILOT01 01-703-1210   F              Placebo       0     Y
53  CDISCPILOT01 01-703-1258   F Xanomeline High Dose      81     Y
54  CDISCPILOT01 01-703-1279   F  Xanomeline Low Dose      54     Y
55  CDISCPILOT01 01-703-1295   F Xanomeline High Dose      81     Y
56  CDISCPILOT01 01-703-1299   F              Placebo       0     Y
57  CDISCPILOT01 01-703-1335   F Xanomeline High Dose      81     Y
58  CDISCPILOT01 01-703-1379   F  Xanomeline Low Dose      54     Y
59  CDISCPILOT01 01-703-1403   M Xanomeline High Dose      81     Y
60  CDISCPILOT01 01-703-1439   F Xanomeline High Dose      81     Y
61  CDISCPILOT01 01-704-1008   F Xanomeline High Dose      81     Y
62  CDISCPILOT01 01-704-1009   M  Xanomeline Low Dose      54     Y
63  CDISCPILOT01 01-704-1010   M              Placebo       0     Y
64  CDISCPILOT01 01-704-1017   M Xanomeline High Dose      81     Y
65  CDISCPILOT01 01-704-1025   F  Xanomeline Low Dose      54     Y
66  CDISCPILOT01 01-704-1065   M Xanomeline High Dose      81     Y
67  CDISCPILOT01 01-704-1074   F Xanomeline High Dose      81     Y
68  CDISCPILOT01 01-704-1093   M Xanomeline High Dose      81     Y
69  CDISCPILOT01 01-704-1114   M  Xanomeline Low Dose      54     Y
70  CDISCPILOT01 01-704-1120   F  Xanomeline Low Dose      54     Y
71  CDISCPILOT01 01-704-1127   F              Placebo       0     Y
72  CDISCPILOT01 01-704-1135   F  Xanomeline Low Dose      54     Y
73  CDISCPILOT01 01-704-1164   F              Placebo       0     Y
74  CDISCPILOT01 01-704-1218   F  Xanomeline Low Dose      54     Y
75  CDISCPILOT01 01-704-1233   F              Placebo       0     Y
76  CDISCPILOT01 01-704-1241   M Xanomeline High Dose      81     Y
77  CDISCPILOT01 01-704-1260   F              Placebo       0     Y
78  CDISCPILOT01 01-704-1266   M Xanomeline High Dose      81     Y
79  CDISCPILOT01 01-704-1323   F  Xanomeline Low Dose      54     Y
80  CDISCPILOT01 01-704-1325   M  Xanomeline Low Dose      54     Y
81  CDISCPILOT01 01-704-1332   M Xanomeline High Dose      81     Y
82  CDISCPILOT01 01-704-1351   M              Placebo       0     Y
83  CDISCPILOT01 01-704-1388   M              Placebo       0     Y
84  CDISCPILOT01 01-704-1435   M              Placebo       0     Y
85  CDISCPILOT01 01-704-1445   M              Placebo       0     Y
86  CDISCPILOT01 01-705-1018   F              Placebo       0     Y
87  CDISCPILOT01 01-705-1031   F  Xanomeline Low Dose      54     Y
88  CDISCPILOT01 01-705-1059   F              Placebo       0     Y
89  CDISCPILOT01 01-705-1186   F              Placebo       0     Y
90  CDISCPILOT01 01-705-1199   M  Xanomeline Low Dose      54     Y
91  CDISCPILOT01 01-705-1280   F Xanomeline High Dose      81     Y
92  CDISCPILOT01 01-705-1281   F Xanomeline High Dose      81     Y
93  CDISCPILOT01 01-705-1282   F              Placebo       0     Y
94  CDISCPILOT01 01-705-1292   F  Xanomeline Low Dose      54     Y
95  CDISCPILOT01 01-705-1303   M Xanomeline High Dose      81     Y
96  CDISCPILOT01 01-705-1310   F Xanomeline High Dose      81     Y
97  CDISCPILOT01 01-705-1349   F              Placebo       0     Y
98  CDISCPILOT01 01-705-1377   F Xanomeline High Dose      81     Y
99  CDISCPILOT01 01-705-1382   M Xanomeline High Dose      81     Y
100 CDISCPILOT01 01-705-1393   F  Xanomeline Low Dose      54     Y
101 CDISCPILOT01 01-705-1431   F  Xanomeline Low Dose      54     Y
102 CDISCPILOT01 01-706-1041   F              Placebo       0     Y
103 CDISCPILOT01 01-706-1049   F Xanomeline High Dose      81     Y
104 CDISCPILOT01 01-706-1384   F  Xanomeline Low Dose      54     Y
105 CDISCPILOT01 01-707-1037   F  Xanomeline Low Dose      54     Y
106 CDISCPILOT01 01-707-1206   M              Placebo       0     Y
107 CDISCPILOT01 01-708-1019   M  Xanomeline Low Dose      54     Y
108 CDISCPILOT01 01-708-1032   M  Xanomeline Low Dose      54     Y
109 CDISCPILOT01 01-708-1084   F  Xanomeline Low Dose      54     Y
110 CDISCPILOT01 01-708-1087   F              Placebo       0     Y
111 CDISCPILOT01 01-708-1158   F              Placebo       0     Y
112 CDISCPILOT01 01-708-1171   F              Placebo       0     Y
113 CDISCPILOT01 01-708-1178   F Xanomeline High Dose      81     Y
114 CDISCPILOT01 01-708-1213   F Xanomeline High Dose      81     Y
115 CDISCPILOT01 01-708-1216   M Xanomeline High Dose      81     Y
116 CDISCPILOT01 01-708-1236   F Xanomeline High Dose      81     Y
117 CDISCPILOT01 01-708-1253   M              Placebo       0     Y
118 CDISCPILOT01 01-708-1272   M  Xanomeline Low Dose      54     Y
119 CDISCPILOT01 01-708-1286   F              Placebo       0     Y
120 CDISCPILOT01 01-708-1296   M              Placebo       0     Y
121 CDISCPILOT01 01-708-1297   M  Xanomeline Low Dose      54     Y
122 CDISCPILOT01 01-708-1316   F              Placebo       0     Y
123 CDISCPILOT01 01-708-1336   M Xanomeline High Dose      81     Y
124 CDISCPILOT01 01-708-1342   F              Placebo       0     Y
125 CDISCPILOT01 01-708-1347   F Xanomeline High Dose      81     Y
126 CDISCPILOT01 01-708-1348   F  Xanomeline Low Dose      54     Y
127 CDISCPILOT01 01-708-1353   F  Xanomeline Low Dose      54     Y
128 CDISCPILOT01 01-708-1372   M Xanomeline High Dose      81     Y
129 CDISCPILOT01 01-708-1378   M              Placebo       0     Y
130 CDISCPILOT01 01-708-1406   F Xanomeline High Dose      81     Y
131 CDISCPILOT01 01-708-1428   F  Xanomeline Low Dose      54     Y
132 CDISCPILOT01 01-709-1001   F              Placebo       0     Y
133 CDISCPILOT01 01-709-1007   F  Xanomeline Low Dose      54     Y
134 CDISCPILOT01 01-709-1020   F  Xanomeline Low Dose      54     Y
135 CDISCPILOT01 01-709-1029   M Xanomeline High Dose      81     Y
136 CDISCPILOT01 01-709-1081   F  Xanomeline Low Dose      54     Y
137 CDISCPILOT01 01-709-1088   M              Placebo       0     Y
138 CDISCPILOT01 01-709-1099   F Xanomeline High Dose      81     Y
139 CDISCPILOT01 01-709-1102   F  Xanomeline Low Dose      54     Y
140 CDISCPILOT01 01-709-1168   F Xanomeline High Dose      81     Y
141 CDISCPILOT01 01-709-1217   M  Xanomeline Low Dose      54     Y
142 CDISCPILOT01 01-709-1238   M Xanomeline High Dose      81     Y
143 CDISCPILOT01 01-709-1259   M              Placebo       0     Y
144 CDISCPILOT01 01-709-1285   M  Xanomeline Low Dose      54     Y
145 CDISCPILOT01 01-709-1301   F              Placebo       0     Y
146 CDISCPILOT01 01-709-1306   F              Placebo       0     Y
147 CDISCPILOT01 01-709-1309   M Xanomeline High Dose      81     Y
148 CDISCPILOT01 01-709-1312   F              Placebo       0     Y
149 CDISCPILOT01 01-709-1326   F  Xanomeline Low Dose      54     Y
150 CDISCPILOT01 01-709-1329   M Xanomeline High Dose      81     Y
151 CDISCPILOT01 01-709-1339   M              Placebo       0     Y
152 CDISCPILOT01 01-709-1424   M Xanomeline High Dose      81     Y
153 CDISCPILOT01 01-710-1002   M  Xanomeline Low Dose      54     Y
154 CDISCPILOT01 01-710-1006   M Xanomeline High Dose      81     Y
155 CDISCPILOT01 01-710-1021   M Xanomeline High Dose      81     Y
156 CDISCPILOT01 01-710-1027   M              Placebo       0     Y
157 CDISCPILOT01 01-710-1045   F  Xanomeline Low Dose      54     Y
158 CDISCPILOT01 01-710-1053   F  Xanomeline Low Dose      54     Y
159 CDISCPILOT01 01-710-1060   M              Placebo       0     Y
160 CDISCPILOT01 01-710-1070   F Xanomeline High Dose      81     Y
161 CDISCPILOT01 01-710-1077   F              Placebo       0     Y
162 CDISCPILOT01 01-710-1078   F              Placebo       0     Y
163 CDISCPILOT01 01-710-1083   F              Placebo       0     Y
164 CDISCPILOT01 01-710-1137   F Xanomeline High Dose      81     Y
165 CDISCPILOT01 01-710-1142   F Xanomeline High Dose      81     Y
166 CDISCPILOT01 01-710-1154   M  Xanomeline Low Dose      54     Y
167 CDISCPILOT01 01-710-1166   F  Xanomeline Low Dose      54     Y
168 CDISCPILOT01 01-710-1183   F              Placebo       0     Y
169 CDISCPILOT01 01-710-1187   F Xanomeline High Dose      81     Y
170 CDISCPILOT01 01-710-1235   F  Xanomeline Low Dose      54     Y
171 CDISCPILOT01 01-710-1249   M Xanomeline High Dose      81     Y
172 CDISCPILOT01 01-710-1264   M              Placebo       0     Y
173 CDISCPILOT01 01-710-1270   F  Xanomeline Low Dose      54     Y
174 CDISCPILOT01 01-710-1271   F              Placebo       0     Y
175 CDISCPILOT01 01-710-1278   M Xanomeline High Dose      81     Y
176 CDISCPILOT01 01-710-1300   F  Xanomeline Low Dose      54     Y
177 CDISCPILOT01 01-710-1314   F              Placebo       0     Y
178 CDISCPILOT01 01-710-1315   F              Placebo       0     Y
179 CDISCPILOT01 01-710-1354   M Xanomeline High Dose      81     Y
180 CDISCPILOT01 01-710-1358   M  Xanomeline Low Dose      54     Y
181 CDISCPILOT01 01-710-1368   F              Placebo       0     Y
182 CDISCPILOT01 01-710-1385   M  Xanomeline Low Dose      54     Y
183 CDISCPILOT01 01-710-1408   M Xanomeline High Dose      81     Y
184 CDISCPILOT01 01-711-1012   F Xanomeline High Dose      81     Y
185 CDISCPILOT01 01-711-1036   M              Placebo       0     Y
186 CDISCPILOT01 01-711-1143   F  Xanomeline Low Dose      54     Y
187 CDISCPILOT01 01-711-1433   F Xanomeline High Dose      81     Y
188 CDISCPILOT01 01-713-1043   F  Xanomeline Low Dose      54     Y
189 CDISCPILOT01 01-713-1073   F  Xanomeline Low Dose      54     Y
190 CDISCPILOT01 01-713-1106   M Xanomeline High Dose      81     Y
191 CDISCPILOT01 01-713-1141   M Xanomeline High Dose      81     Y
192 CDISCPILOT01 01-713-1179   F              Placebo       0     Y
193 CDISCPILOT01 01-713-1209   F Xanomeline High Dose      81     Y
194 CDISCPILOT01 01-713-1256   M              Placebo       0     Y
195 CDISCPILOT01 01-713-1269   M              Placebo       0     Y
196 CDISCPILOT01 01-713-1448   F  Xanomeline Low Dose      54     Y
197 CDISCPILOT01 01-714-1035   F              Placebo       0     Y
198 CDISCPILOT01 01-714-1068   F  Xanomeline Low Dose      54     Y
199 CDISCPILOT01 01-714-1195   M  Xanomeline Low Dose      54     Y
200 CDISCPILOT01 01-714-1288   M Xanomeline High Dose      81     Y
201 CDISCPILOT01 01-714-1375   F              Placebo       0     Y
202 CDISCPILOT01 01-714-1425   M Xanomeline High Dose      81     Y
203 CDISCPILOT01 01-715-1085   F  Xanomeline Low Dose      54     Y
204 CDISCPILOT01 01-715-1107   M  Xanomeline Low Dose      54     Y
205 CDISCPILOT01 01-715-1155   F              Placebo       0     Y
206 CDISCPILOT01 01-715-1207   F              Placebo       0     Y
207 CDISCPILOT01 01-715-1319   M Xanomeline High Dose      81     Y
208 CDISCPILOT01 01-715-1321   F Xanomeline High Dose      81     Y
209 CDISCPILOT01 01-715-1397   F              Placebo       0     Y
210 CDISCPILOT01 01-715-1405   M  Xanomeline Low Dose      54     Y
211 CDISCPILOT01 01-716-1024   F              Placebo       0     Y
212 CDISCPILOT01 01-716-1026   F              Placebo       0     Y
213 CDISCPILOT01 01-716-1030   F Xanomeline High Dose      81     Y
214 CDISCPILOT01 01-716-1044   M              Placebo       0     Y
215 CDISCPILOT01 01-716-1063   M  Xanomeline Low Dose      54     Y
216 CDISCPILOT01 01-716-1071   F Xanomeline High Dose      81     Y
217 CDISCPILOT01 01-716-1094   M  Xanomeline Low Dose      54     Y
218 CDISCPILOT01 01-716-1103   M  Xanomeline Low Dose      54     Y
219 CDISCPILOT01 01-716-1108   F              Placebo       0     Y
220 CDISCPILOT01 01-716-1151   F  Xanomeline Low Dose      54     Y
221 CDISCPILOT01 01-716-1157   M  Xanomeline Low Dose      54     Y
222 CDISCPILOT01 01-716-1160   F              Placebo       0     Y
223 CDISCPILOT01 01-716-1167   M  Xanomeline Low Dose      54     Y
224 CDISCPILOT01 01-716-1177   M              Placebo       0     Y
225 CDISCPILOT01 01-716-1189   M Xanomeline High Dose      81     Y
226 CDISCPILOT01 01-716-1229   F Xanomeline High Dose      81     Y
227 CDISCPILOT01 01-716-1298   F  Xanomeline Low Dose      54     Y
228 CDISCPILOT01 01-716-1308   F              Placebo       0     Y
229 CDISCPILOT01 01-716-1311   M  Xanomeline Low Dose      54     Y
230 CDISCPILOT01 01-716-1364   F Xanomeline High Dose      81     Y
231 CDISCPILOT01 01-716-1373   M Xanomeline High Dose      81     Y
232 CDISCPILOT01 01-716-1418   F Xanomeline High Dose      81     Y
233 CDISCPILOT01 01-716-1441   M              Placebo       0     Y
234 CDISCPILOT01 01-716-1447   F Xanomeline High Dose      81     Y
235 CDISCPILOT01 01-717-1004   F  Xanomeline Low Dose      54     Y
236 CDISCPILOT01 01-717-1109   M Xanomeline High Dose      81     Y
237 CDISCPILOT01 01-717-1174   M Xanomeline High Dose      81     Y
238 CDISCPILOT01 01-717-1201   F              Placebo       0     Y
239 CDISCPILOT01 01-717-1344   F              Placebo       0     Y
240 CDISCPILOT01 01-717-1357   M Xanomeline High Dose      81     Y
241 CDISCPILOT01 01-717-1446   F  Xanomeline Low Dose      54     Y
242 CDISCPILOT01 01-718-1066   F  Xanomeline Low Dose      54     Y
243 CDISCPILOT01 01-718-1079   F  Xanomeline Low Dose      54     Y
244 CDISCPILOT01 01-718-1101   M Xanomeline High Dose      81     Y
245 CDISCPILOT01 01-718-1139   M              Placebo       0     Y
246 CDISCPILOT01 01-718-1150   F              Placebo       0     Y
247 CDISCPILOT01 01-718-1170   F  Xanomeline Low Dose      54     Y
248 CDISCPILOT01 01-718-1172   M              Placebo       0     Y
249 CDISCPILOT01 01-718-1250   F  Xanomeline Low Dose      54     Y
250 CDISCPILOT01 01-718-1254   M  Xanomeline Low Dose      54     Y
251 CDISCPILOT01 01-718-1328   M Xanomeline High Dose      81     Y
252 CDISCPILOT01 01-718-1355   M              Placebo       0     Y
253 CDISCPILOT01 01-718-1371   F Xanomeline High Dose      81     Y
254 CDISCPILOT01 01-718-1427   F Xanomeline High Dose      81     Y</code></pre>
</div>
</div>
<p><code>wrangle_data()</code>의 <strong>출력</strong>은 총 6개의 열을 가지며 <code>"SAFFL"</code> 열은 필터링하는 것이므로 <code>"Y"</code> 값만 포함할 것으로 예상합니다.</p>
<p><a href="https://testthat.r-lib.org/reference/equality-expectations.html"><code>expect_equal()</code></a> 테스트를 사용하여 반환된 <code>SAFFL</code> 열에 <code>Y</code> 값만 포함되어 있고 해당 열에 <code>NA</code> 값이 없는지 확인합니다. <code>expect_equal(object, expected)</code> 함수는 두 개의 인수, 즉 <em>object</em>(계산), <em>expected</em>(비교할 값)를 사용합니다.</p>
<p>첫 번째 테스트에서는 <code>unique()</code> 함수를 사용하여 <code>adsl_data$SAFFL</code> 열의 고유 값을 결정하며, 이는 <code>Y</code>일 것으로 예상되므로 <code>expect_equal()</code> 함수의 두 번째 인수입니다.</p>
<p>아래 <code>expect_equal()</code> 테스트를 실행해도 출력이 제공되지 않는다는 점에 유의하십시오. 이는 통과하는 개별 테스트를 실행하는 경우에 예상되는 것입니다. 테스트에서 오류가 발생하거나 함수 또는 기능을 테스트하는 여러 기대치를 그룹화하면 출력을 얻을 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle_data() 출력을 adsl_data 객체에 할당</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>adsl_data <span class="ot">&lt;-</span> <span class="fu">wrangle_data</span>(phuse_data)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 테스트 생성</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">unique</span>(adsl_data<span class="sc">$</span>SAFFL), <span class="st">"Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>아래 두 번째 테스트에서는 <code>is.na</code> 및 <code>sum</code> 함수를 사용하여 <code>adsl_data$SAFFL</code> 열에 결측값이 없는지 확인합니다. <em>MiniProject8 - 함수 적용</em>에서 <code>is.na</code> 함수의 도움으로 R이 SAFFL 변수의 값이 누락되었는지 여부를 평가하여 모든 관측치에 대해 동시에 <code>TRUE</code> 또는 <code>FALSE</code>를 생성한다는 것을 배웠습니다. 그런 다음 <code>TRUE</code> = 1이고 <code>FALSE</code> = 0인 해당 값의 합계를 구합니다. 이렇게 하면 열의 결측값 수가 제공되며, 이 경우 0일 것으로 예상합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(adsl_data<span class="sc">$</span>SAFFL)), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>출력 데이터 세트에 6개의 열만 포함되어야 한다는 기대치에 대한 테스트도 만들어 보겠습니다. <a href="https://testthat.r-lib.org/reference/expect_length.html"><code>expect_length()</code></a> .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_length</span>(<span class="fu">names</span>(adsl_data), <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>{test_that}</strong>을 사용하면 함수나 기능을 테스트하는 여러 기대치를 그룹화할 수 있습니다. 기대치를 그룹화하려면 아래에 표시된 <code>test_that(desc, code)</code>를 사용하여 각 기대치의 이름을 지정해야 합니다. 이름을 지정하면 실패한 테스트를 더 쉽게 식별할 수 있습니다.</p>
<p>아래 코드를 실행하고 오류를 살펴본 다음 그에 따라 수정하십시오. 오류가 얼마나 사용자 친화적인지 확인하십시오!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"wrangle_data() 출력이 올바릅니다"</span>, {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  adsl_data <span class="ot">&lt;-</span> <span class="fu">wrangle_data</span>(adsl_data)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_success</span>(<span class="fu">expect_equal</span>(<span class="fu">unique</span>(adsl_data<span class="sc">$</span>SAFFL), <span class="st">"Y"</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_success</span>(<span class="fu">expect_equal</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(adsl_data<span class="sc">$</span>SAFFL)), <span class="dv">0</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_success</span>(<span class="fu">expect_length</span>(<span class="fu">names</span>(adsl_data), <span class="dv">5</span>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>함수가 올바르게 수행되면 세 가지 테스트가 모두 성공할 것으로 예상되므로 각 테스트를 <a href="https://testthat.r-lib.org/reference/expect_success.html"><code>expect_success()</code></a> 함수로 래핑할 수도 있습니다. <code>expect_failure()</code> 함수를 사용하여 기대치를 테스트하고 오류를 포착할 수도 있습니다. 출력 데이터 SAFFL 열에 “N” 값이 있는 경우 아래 <code>expect_equal()</code>이 실패할 것으로 예상합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_failure</span>(<span class="fu">expect_equal</span>(<span class="fu">unique</span>(adsl_data<span class="sc">$</span>SAFFL), <span class="st">"N"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>또한 <code>wrangle_data()</code> 함수의 <strong>출력</strong>이 <code>calculate_Big_N_cnt()</code> 및 <code>calculate_small_n_cnt()</code>의 <strong>입력</strong>이 될 것이며 이러한 함수에 대한 <strong>입력</strong> 데이터가 기대치를 충족하는지 확인하는 것이 중요하다는 것을 기억해야 합니다. 그렇지 않으면 전체 파이프라인이 중단됩니다.</p>
<p>이제 <code>wrangle_data()</code> <strong>출력</strong>(<code>adsl_data</code> 객체)이 <code>calculate_Big_N_cnt()</code> 및 <code>calculate_small_n_cnt()</code> 함수의 <strong><em>입력</em></strong>이 될 것이며 이러한 함수가 데이터에 특정 열이 있어야 하므로 예상 열 이름을 포함하는지 확인하는 테스트를 만들어 보겠습니다. 이를 테스트하는 데 도움이 되도록 <code>expected_vars</code>라는 예상 이름이 있는 벡터를 만들어 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>expected_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TRT01AN"</span>, <span class="st">"TRT01A"</span>, <span class="st">"SEX"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>%in%</code> 연산자를 사용하여 “TRT01AN” “TRT01A” 및 “SEX” 열 이름이 데이터에 있는지 확인할 수 있습니다. 아래 코드는 두 벡터, 즉 위에서 만든 <code>expected_vars</code>와 <code>adsl_data</code> 출력의 열 이름 벡터를 비교합니다. R은 <code>expected_vars</code> 변수의 값이 <code>names(adsl_data)</code>에 있는지 여부를 평가하여 <code>expected_vars</code>의 모든 관측치에 대해 <code>TRUE</code> 또는 <code>FALSE</code>를 생성합니다. 위에서 그리고 <em>MiniProject8</em>에서 배운 것처럼 <code>TRUE</code> = 1이고 <code>FALSE</code> = 0인 해당 값의 합계를 구할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(expected_vars <span class="sc">%in%</span> <span class="fu">names</span>(adsl_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>코드를 실행할 때 세 열이 모두 데이터에 있는 경우 예상되는 값인 <code>3</code>을 받았습니다. 이제 <code>expect_equal()</code> 함수를 사용하여 테스트를 작성해 보겠습니다. 기대치를 설정하여 아래 테스트 코드를 완성하십시오.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"예상 열이 모두 wrangle_data() 출력에 있습니다"</span>, {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>( , )</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>좋습니다! 이제 <code>wrangle_data()</code> 함수의 입력 및 출력을 확인하는 테스트를 만들었으므로 <code>calculate_Big_N_cnt()</code> 및 <code>calculate_small_n_cnt()</code> 함수 테스트를 살펴보겠습니다.</p>
<p>지금까지 ADSL 데이터에 특정한 기대치(예: 열 이름 또는 쉽게 확인할 수 있는 특정 기대치)를 테스트하는 데 도움이 되도록 테스트 PHUSE 데이터 세트를 사용해 왔습니다. 그러나 신뢰할 수 있는 테스트 데이터를 사용할 수 없거나 특정 기대치를 테스트하는 데 사용하기 쉽지 않을 수 있습니다. 특히 특정 계산을 테스트해야 하는 경우 자체 테스트 데이터를 만드는 것이 매우 일반적입니다.</p>
<p><code>calculate_Big_N_cnt()</code> 및 <code>calculate_small_n_cnt()</code> 함수를 테스트하기 위해 <code>adsl_data</code> 출력을 모방하지만 관리하기 쉬운 자체 테스트 데이터를 만들 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> <span class="sc">~</span>STUDYID,  <span class="sc">~</span>TRT01AN,   <span class="sc">~</span>TRT01A,       <span class="sc">~</span>SEX,    <span class="sc">~</span>SAFFL, <span class="sc">~</span>USUBJID,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a> <span class="st">"CDISCPILOT01"</span>,    <span class="dv">1</span>,     <span class="st">"Treatment A"</span>,  <span class="st">'Female'</span>,  <span class="st">"Y"</span>,   <span class="st">"01-701-1015"</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a> <span class="st">"CDISCPILOT01"</span>,    <span class="dv">1</span>,     <span class="st">"Treatment A"</span>,  <span class="st">'Male'</span>,    <span class="st">"Y"</span>,   <span class="st">"01-701-1023"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a> <span class="st">"CDISCPILOT01"</span>,    <span class="dv">2</span>,     <span class="st">"Treatment B"</span>,  <span class="st">'Female'</span>,  <span class="st">"Y"</span>,   <span class="st">"01-701-1180"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a> <span class="st">"CDISCPILOT01"</span>,    <span class="dv">1</span>,     <span class="st">"Treatment A"</span>,  <span class="st">'Male'</span>,    <span class="st">"Y"</span>,   <span class="st">"01-701-1138"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a> <span class="st">"CDISCPILOT01"</span>,    <span class="dv">1</span>,     <span class="st">"Treatment A"</span>,  <span class="st">'Female'</span>,  <span class="st">"Y"</span>,   <span class="st">"01-702-1145"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a> <span class="st">"CDISCPILOT01"</span>,    <span class="dv">2</span>,     <span class="st">"Treatment B"</span>,  <span class="st">'Male'</span>,    <span class="st">"Y"</span>,   <span class="st">"01-702-1180"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a> <span class="st">"CDISCPILOT01"</span>,    <span class="dv">2</span>,     <span class="st">"Treatment B"</span>,  <span class="st">'Female'</span>,  <span class="st">"Y"</span>,   <span class="st">"01-703-1558"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a> <span class="st">"CDISCPILOT01"</span>,    <span class="dv">1</span>,     <span class="st">"Treatment A"</span>,  <span class="st">'Male'</span>,    <span class="st">"Y"</span>,   <span class="st">"01-703-1678"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>calculate_Big_N_cnt()</code> 함수는 <code>"TRT01AN"</code>, <code>"TRT01A"</code> 및 <code>"N"</code>의 세 열만 포함할 것으로 예상되는 <code>Big_N_cnt</code> tibble <strong><em>출력</em></strong>을 만듭니다. 이 경우 객체의 정확한 열 수와 이름을 예상 문자 벡터와 일치시키는 <a href="https://testthat.r-lib.org/reference/expect_named.html"><code>expect_named()</code></a> 함수를 사용할 수 있습니다.</p>
<p>위 테스트 예제에서는 명명된 벡터를 만들었고 아래 예제에서는 예상 이름을 저장하기 위해 명명되지 않은 벡터를 사용했습니다. 이 두 가지 모두 유효한 접근 방식입니다. 경험상 동일한 벡터를 반복적으로 재사용할 경우 별도의 객체로 저장하는 것이 좋으며 여러 테스트 파일에서 재사용할 경우 별도의 파일에 저장하는 것이 좋습니다. 이에 대해서는 아래 <strong><em>테스트 구성 및 실행</em></strong> 섹션에서 자세히 설명합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"예상 열이 모두 calculate_Big_N_cnt() 출력에 있습니다"</span>, {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_named</span>(<span class="fu">calculate_Big_N_cnt</span>(test_data), <span class="fu">c</span>(<span class="st">"TRT01AN"</span>, <span class="st">"TRT01A"</span>, <span class="st">"N"</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test passed 🎊</code></pre>
</div>
</div>
<p><code>calculate_Big_N_cnt()</code><strong>출력</strong> 데이터에 대해 또 무엇을 기대합니까? 우리는 그것이 어떤 차원을 가져야 하는지 정확히 알고 있습니다. 항상 세 개의 열과 치료 그룹 수에 해당하는 행 수를 가져야 합니다. <code>expect_equal(object, expected)</code> 함수를 사용하여 이 기대치를 설정할 수 있습니다.</p>
<p><code>expect_equal()</code>의 첫 번째 <code>object</code> 인수에 대해 <code>dim()</code>을 사용할 것입니다. <code>dim()</code> 함수는 두 개의 숫자 벡터( <code>calculate_Big_N_cnt()</code> 출력 객체의 행 수와 열 수)를 제공합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">calculate_Big_N_cnt</span>(test_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3</code></pre>
</div>
</div>
<p><code>expect_equal()</code>의 두 번째 <code>expected</code> 인수에 대해 두 값의 벡터를 사용할 것입니다:</p>
<p>첫 번째 값은 출력 데이터 세트의 치료 그룹 수에 해당하는 행 수입니다. <code>unique()</code> 함수를 사용하여 고유한 치료 그룹 수를 결정하고 <code>length()</code>를 사용하여 그룹을 계산합니다. 행 수를 하드코딩하는 대신 이러한 함수를 사용하면 테스트 코드가 지금 작업하는 것뿐만 아니라 필요한 경우 다른 테스트 데이터에 대해서도 작동하도록 보장할 수 있습니다.</p>
<p>두 번째 값은 출력 데이터셋에 항상 3개의 열이 있을 것으로 예상되므로 하드코딩할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">calculate_Big_N_cnt</span>(test_data)<span class="sc">$</span>TRT01A)), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3</code></pre>
</div>
</div>
<p>이제 이 두 인수를 테스트 <code>expect_equal()</code> 테스트에 결합할 준비가 되었습니다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"calculate_Big_N_cnt() 출력에 예상 차원, 열 및 유형이 있습니다"</span>, {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">dim</span>(<span class="fu">calculate_Big_N_cnt</span>(test_data)), <span class="fu">c</span>(<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">calculate_Big_N_cnt</span>(test_data)<span class="sc">$</span>TRT01A)), <span class="dv">3</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test passed 😀</code></pre>
</div>
</div>
<p>이전에 만든 <code>calculate_small_n_cnt</code> 함수를 잊지 말고 해당 함수에 대한 데이터 <strong>출력</strong>에 대한 몇 가지 기대치를 설정해 보겠습니다. 함수에서 반환되는 <code>small_n_cnt</code> 출력에 대한 올바른 기대치를 갖도록 아래 함수를 완성하십시오. <code>small_n_cnt</code> 객체는 <code>Big_N_cnt</code> 상대보다 더 많은 열과 행을 반환한다는 것을 기억하십시오. 또한 치료 그룹이 성별로도 나뉘기 때문에 두 배 많은 행을 얻게 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"calculate_small_n_cnt() 출력에 예상 차원, 열 및 유형이 있습니다"</span>, {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">expect_named</span>( , )</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">expect_equal</span>( , )</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이제 지금까지 만든 모든 테스트를 모아 함께 넣어 보겠습니다. 모든 관련 테스트를 함께 결합하고 그에 따라 test_that 설명을 업데이트할 수 있다는 것을 기억하십시오. 여기에 <code>calculate_small_n_cnt</code> 테스트 세트도 추가하십시오.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"wrangle_data() 출력에 예상 차원 및 값이 있습니다"</span>, {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_success</span>(<span class="fu">expect_equal</span>(<span class="fu">unique</span>(adsl_data<span class="sc">$</span>SAFFL), <span class="st">"Y"</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_success</span>(<span class="fu">expect_equal</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(adsl_data<span class="sc">$</span>SAFFL)), <span class="dv">0</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_success</span>(<span class="fu">expect_length</span>(<span class="fu">names</span>(adsl_data), <span class="dv">6</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">sum</span>(expected_vars <span class="sc">%in%</span> <span class="fu">names</span>(adsl_data)), <span class="dv">3</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"calculate_Big_N_cnt() 출력에 예상 차원, 열 및 유형이 있습니다"</span>, {</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  test_Big_N_cnt <span class="ot">&lt;-</span> <span class="fu">calculate_Big_N_cnt</span>(test_data)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_named</span>(test_Big_N_cnt, <span class="fu">c</span>(<span class="st">"TRT01AN"</span>, <span class="st">"TRT01A"</span>, <span class="st">"N"</span>))</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">dim</span>(test_Big_N_cnt), <span class="fu">c</span>(<span class="fu">length</span>(<span class="fu">unique</span>(test_Big_N_cnt<span class="sc">$</span>TRT01A)), <span class="dv">3</span>))</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_type</span>(test_Big_N_cnt<span class="sc">$</span>N, <span class="st">"integer"</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>두 번째 테스트 세트에 이전에 다루지 않은 <a href="https://testthat.r-lib.org/reference/inheritance-expectations.html"><code>expect_type()</code></a>이 있다는 것을 알아차렸습니까? 이 함수는 매우 자명하며 코드가 함수에 들어오고 나가는 특정 입력/출력 데이터 유형에 의존하는 경우 알아두면 매우 유용하고 중요한 함수입니다.</p>
<p>이제 <code>calculate_small_n_cnt</code> 및 <code>Big_N_cnt</code> 출력의 값이 예상대로 계산되는지 확인하는 테스트를 만들어야 하므로 <code>calculate_small_n_cnt()</code> 및 <code>calculate_Big_N_cnt()</code> <strong>계산</strong>에 대한 기대치를 설정하는 것에 대해 이야기해 보겠습니다. 이를 위해 더 작은 데이터 세트에서 계산이 올바르게 수행되는지 확인하기가 매우 쉬울 것이므로 다시 <code>test_data</code>를 사용할 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  STUDYID      TRT01AN TRT01A      SEX    SAFFL USUBJID    
  &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;      
1 CDISCPILOT01       1 Treatment A Female Y     01-701-1015
2 CDISCPILOT01       1 Treatment A Male   Y     01-701-1023
3 CDISCPILOT01       2 Treatment B Female Y     01-701-1180
4 CDISCPILOT01       1 Treatment A Male   Y     01-701-1138
5 CDISCPILOT01       1 Treatment A Female Y     01-702-1145
6 CDISCPILOT01       2 Treatment B Male   Y     01-702-1180</code></pre>
</div>
</div>
<p><code>calculate_Big_N_cnt()</code>는 치료 그룹당 발생 횟수를 계산하므로 <code>test_data</code>를 보면 <code>calculate_Big_N_cnt()</code>를 적용할 때 “치료 A”에 대해 N=5, “치료 B”에 대해 N=3을 얻어야 한다는 것을 쉽게 알 수 있습니다. <strong>만약</strong> 우리 함수가 예상대로 작동한다면. 테스트를 작성하고 우리 함수가 테스트를 통과하는지 확인해 보겠습니다.</p>
<p>먼저 함수를 테스트 데이터에 적용하고 <code>test_Big_N_cnt</code> 객체에 할당한 다음 <code>expect_equal</code> 함수를 사용하여 가정이 올바른지 확인합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"calculate_Big_N_cnt()가 올바른 계산을 생성합니다"</span>, {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>test_Big_N_cnt <span class="ot">&lt;-</span> <span class="fu">calculate_Big_N_cnt</span>(test_data)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_equal</span>(test_Big_N_cnt<span class="sc">$</span>N, <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test passed 🎊</code></pre>
</div>
</div>
<p><code>calculate_small_n_cnt()</code>에 대해 동일한 기대치를 테스트해 보겠습니다. 그룹당 치료당 발생 횟수를 계산한다는 점을 고려하십시오. 참고로 R은 달리 지정하지 않는 한 기본적으로 알파벳순으로 정렬합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"calculate_small_n_cnt()가 올바른 계산을 생성합니다"</span>, {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>test_small_n_cnt <span class="ot">&lt;-</span> <span class="fu">calculate_small_n_cnt</span>(test_data)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">head</span>(test_small_n_cnt<span class="sc">$</span>n, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test passed 🎊</code></pre>
</div>
</div>
<p>또한 치료당 성별별로 작은 n 값의 합계를 만들 때 큰 N과 동일한 값을 가질 것으로 예상되므로 테스트를 작성해 보겠습니다. <code>test_small_n_cnt</code>(<code>calculate_small_n_cnt(test_data)</code> 출력)를 보고 구조를 상기시켜 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>test_small_n_cnt <span class="ot">&lt;-</span> <span class="fu">calculate_small_n_cnt</span>(test_data)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>test_small_n_cnt  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   TRT01AN, TRT01A, SEX [4]
  TRT01AN TRT01A      SEX    .groups     n
    &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;   &lt;int&gt;
1       1 Treatment A Female drop        2
2       1 Treatment A Male   drop        3
3       2 Treatment B Female drop        2
4       2 Treatment B Male   drop        1</code></pre>
</div>
</div>
<p>치료당 성별별로 <code>n</code> 값의 합계를 계산하려면 <code>aggregate()</code> 함수를 사용할 수 있습니다. R의 <code>aggregate()</code> 함수는 데이터를 하위 집합으로 분할하고 각 하위 집합에 대해 지정된 요약 통계를 계산한 다음 그룹별 형식으로 결과를 반환합니다. 아래 콘솔에서 <code>?aggregate</code>를 입력하고 아래에서 사용하는 <code>x</code>, <code>by</code> 및 <code>FUN</code> 인수에 대한 설명을 살펴보십시오. <code>aggregate()</code> 함수의 결과를 테스트에서 사용할 새 <code>aggregate_small_n_cnt</code> 변수에 할당해야 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>aggregate_small_n_cnt <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="at">x =</span> test_small_n_cnt<span class="sc">$</span>n, <span class="at">by=</span><span class="fu">list</span>(<span class="at">TRT01A=</span>test_small_n_cnt<span class="sc">$</span>TRT01A), <span class="at">FUN=</span>sum)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>aggregate_small_n_cnt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       TRT01A x
1 Treatment A 5
2 Treatment B 3</code></pre>
</div>
</div>
<p><code>aggregate()</code>는 이 목적에 매우 적합한 기본 R 함수이지만 {<a href="https://dplyr.tidyverse.org/index.html">dplyr</a>} 패키지의 <code>group_by()</code> 및 <code>summarize()</code> 함수를 대안으로 사용하여 동일한 결과를 얻을 수 있습니다. 아래 코드를 실행하여 <code>aggregate()</code> 함수의 출력과 동일한 결과를 생성하는지 확인하십시오. R에서 동일한 작업을 수행하는 여러 가지 방법이 있다는 점에 유의하는 것이 중요합니다. 수많은 R 패키지, 기본 R 함수 및 이 둘의 조합은 광범위한 솔루션을 제공합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>aggregate_small_n_cnt <span class="ot">&lt;-</span> test_small_n_cnt <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(TRT01A) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">x =</span> <span class="fu">sum</span>(n))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>aggregate_small_n_cnt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  TRT01A          x
  &lt;chr&gt;       &lt;int&gt;
1 Treatment A     5
2 Treatment B     3</code></pre>
</div>
</div>
<p>이제 <code>calculate_Big_N_cnt(test_data)</code> 출력의 <code>N</code> 열과 동일한 값을 포함할 것으로 예상되는 <code>x</code> 열이 있는 새 <code>aggregate_small_n_cnt</code> 객체가 있습니다. 결과가 동일한지 확인해 보겠습니다. 이를 위해 <code>expect_identical</code> 함수를 사용할 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"큰 n과 요약된 작은 n이 동일합니다"</span>, {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  aggregate_small_n_cnt <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> test_small_n_cnt<span class="sc">$</span>n, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">by=</span><span class="fu">list</span>(<span class="at">TRT01A=</span>test_small_n_cnt<span class="sc">$</span>TRT01A), </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN=</span>sum)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  test_Big_N_cnt <span class="ot">&lt;-</span> <span class="fu">calculate_Big_N_cnt</span>(test_data)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_identical</span>(aggregate_small_n_cnt<span class="sc">$</span>x, test_Big_N_cnt<span class="sc">$</span>N)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>})  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test passed 🎊</code></pre>
</div>
</div>
<p>좋습니다! 이제 잘못될 수 있는 몇 가지 상황을 고려했으며 특정 테스트가 통과하지 못하면 테스트가 오류가 어디에 있는지 정확히 알려주므로 코드를 디버깅하기가 더 쉬워질 것입니다.</p>
<p><strong>데이터 테스트의 표면만 긁었을 뿐</strong>이며 훨씬 더 많은 사례, 패키지, 자습서 및 훌륭한 예제가 있다는 것을 기억하십시오! 다음은 몇 가지 예입니다:</p>
<ul>
<li><p><a href="https://r-pkgs.org/testing-basics.html">R 패키지: 테스트 기본 사항</a></p></li>
<li><p><a href="https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf">testthat: 테스트 시작하기</a></p></li>
<li><p><a href="https://www.pipinghotdata.com/posts/2021-11-23-getting-started-with-unit-testing-in-r/">R에서 단위 테스트 시작하기</a></p></li>
<li><p><a href="https://www.rstudio.com/conference/2022/talks/shinytest2-unit-testing-for-shiny/">{shinytest2}: Shiny 응용 프로그램을 위한 단위 테스트</a></p></li>
<li><p><a href="https://www.r-bloggers.com/2019/11/automated-testing-with-testthat-in-practice/" class="uri">https://www.r-bloggers.com/2019/11/automated-testing-with-testthat-in-practice/</a></p></li>
<li><p><a href="https://covr.r-lib.org/">패키지에 대한 테스트 적용 범위 • covr</a></p></li>
</ul>
</section>
<section id="테스트-구성-및-실행" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="테스트-구성-및-실행"><span class="header-section-number">11.8</span> 테스트 구성 및 실행</h2>
<p><strong>{testthat}</strong>은 일부 설정 이점을 “무료로” 얻을 수 있으므로 패키지 워크플로 내에서 가장 잘 작동하지만 {testthat}을 활용하기 위해 패키지를 만들 필요는 없지만 원활한 테스트 경험을 위해 따라야 할 몇 가지 규칙이 있습니다.</p>
<p>폴더 구조는 다음과 같아야 합니다:</p>
<p><img src="img/folder_structure.png" class="img-fluid"></p>
<p>모든 R 스크립트를 <code>R</code>이라는 폴더에 정리하고 모든 테스트를 <code>test/testthat</code> 폴더에 보관해야 합니다. testthat 테스트는 <code>tests/testthat/</code> 아래 파일에 있어야 하며 이러한 파일 이름은 <strong>반드시</strong> <code>test</code>로 시작해야 합니다. 테스트 파일 이름은 testthat 출력에 표시되어 유용한 컨텍스트를 제공합니다.</p>
<p>이 MiniProject12를 다운로드(복제)할 때 <em>MiniProject12_Example</em> 폴더도 함께 다운로드(복제)했습니다. <em>MiniProject12_Example</em> 폴더 안에는 테스트 구조를 설정하는 방법에 대한 예제가 있습니다. 폴더를 탐색하고 파일 구조와 내용을 확인할 수 있습니다. 폴더에는 <em>Example.Rproj</em>도 포함되어 있습니다. 프로젝트를 두 번 클릭하면 테스트를 실행할 수 있는 미리 구성된 디렉토리 설정이 있는 새 R 세션이 열립니다. <em>MiniProject12_Example.Rproj</em>을 열면 <code>tests/testthat/testthat.R</code>로 이동하여 스크립트를 실행하십시오. 콘솔에서 테스트 세부 정보를 볼 수 있습니다. 탐색을 마쳤으면 RStudio IDE의 오른쪽 상단 모서리로 이동하여 “프로젝트 닫기”를 클릭하십시오.</p>
<p><img src="img/close_project.png" class="img-fluid"></p>
</section>
<section id="챌린지" class="level2" data-number="11.9">
<h2 data-number="11.9" class="anchored" data-anchor-id="챌린지"><span class="header-section-number">11.9</span> 챌린지</h2>
<p>아직 테스트해야 할 <code>adsl_counts()</code>가 있습니다! 함수를 탐색하고 <code>perc</code> 값이 올바르게 계산되었는지 테스트하는 테스트를 만드십시오. 함수 내에서 발생하는 다른 데이터 변환에 대해 생각하고 예기치 않은 입력/출력, 오류를 포착하는 테스트를 작성하십시오.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate_Big_N_cnt 함수 생성</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>calculate_Big_N_cnt <span class="ot">&lt;-</span> <span class="cf">function</span>(adsl_data) {</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  Big_N_cnt <span class="ot">&lt;-</span>  adsl_data   <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>( TRT01AN, TRT01A ) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"N"</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Big_N_cnt)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate_small_n_cnt 함수 생성</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>calculate_small_n_cnt <span class="ot">&lt;-</span> <span class="cf">function</span>(adsl_data) {</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  small_n_cnt <span class="ot">&lt;-</span>  adsl_data  <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>( TRT01AN, TRT01A,  SEX ) <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"n"</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(small_n_cnt)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co"># adsl_counts 함수 생성 </span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>adsl_counts <span class="ot">&lt;-</span> <span class="cf">function</span>(adsl_data, Big_N_cnt, small_n_cnt) {</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  adsl_mrg_cnt <span class="ot">&lt;-</span> small_n_cnt <span class="sc">%&gt;%</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(Big_N_cnt, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"TRT01A"</span>, <span class="st">"TRT01AN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">perc =</span> <span class="fu">round</span>((n<span class="sc">/</span>N)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="fu">recode</span>(SEX, </span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"M"</span> <span class="ot">=</span> <span class="st">"Male"</span>,</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"Female"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(TRT01A, SEX, perc)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(adsl_mrg_cnt)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 계산</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>Big_N_cnt <span class="ot">&lt;-</span> <span class="fu">calculate_Big_N_cnt</span>(test_data)</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>small_n_cnt <span class="ot">&lt;-</span> <span class="fu">calculate_small_n_cnt</span>(test_data)</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="co"># adsl_counts() 함수 적용 </span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>adsl_test_data <span class="ot">&lt;-</span>  test_data <span class="sc">%&gt;%</span> </span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adsl_counts</span>(., Big_N_cnt, small_n_cnt)</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>adsl_test_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  TRT01A      SEX     perc
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Treatment A Female  40  
2 Treatment A Male    60  
3 Treatment B Female  66.7
4 Treatment B Male    33.3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co"> adsl_counts()에 대한 테스트 케이스 생성</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./MiniProject11_ko.html" class="pagination-link" aria-label="깔끔한 평가">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">깔끔한 평가</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./MiniProject13_ko.html" class="pagination-link" aria-label="코드 스타일">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">코드 스타일</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>