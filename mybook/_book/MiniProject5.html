<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mike K Smith">
<meta name="dcterms.date" content="2023-02-16">

<title>4&nbsp; Mini-project 5 - Getting started with {ggplot2} – Pharma Hands-on Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./MiniProject6.html" rel="next">
<link href="./MiniProject4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-cd63b520c5e060288b5099369e8bcbf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./MiniProject5.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mini-project 5 - Getting started with {ggplot2}</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pharma Hands-on Exercises</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Mini-project 1 - Reading and exploring datasets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Mini-project 2 - Summarising continuous and categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Mini-project 4 - Creating summary table data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mini-project 5 - Getting started with {ggplot2}</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mini-project 6 - {ggplot2} extensions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mini-project 7 - Getting started writing functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Mini-project 8 - Applying functions through iteration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Mini-project 9 - Reproducible examples and {reprex}</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mini-project 10 - Debugging</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mini-project 11 - Tidy evaluation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Mini-project 12 - Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Mini-project13 - Code style</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MiniProject14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Mini-project 14 - R snippets</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-source" id="toc-data-source" class="nav-link active" data-scroll-target="#data-source"><span class="header-section-number">4.1</span> Data Source</a></li>
  <li><a href="#create-a-dataset" id="toc-create-a-dataset" class="nav-link" data-scroll-target="#create-a-dataset"><span class="header-section-number">4.2</span> 1. Create a dataset</a></li>
  <li><a href="#use-basic-ggplot-function" id="toc-use-basic-ggplot-function" class="nav-link" data-scroll-target="#use-basic-ggplot-function"><span class="header-section-number">4.3</span> 2. Use basic ggplot function</a></li>
  <li><a href="#add-points-to-the-canvas-created-in-the-previous-step." id="toc-add-points-to-the-canvas-created-in-the-previous-step." class="nav-link" data-scroll-target="#add-points-to-the-canvas-created-in-the-previous-step."><span class="header-section-number">4.4</span> 3. Add points to the “canvas” created in the previous step.</a></li>
  <li><a href="#identify-groups-of-data" id="toc-identify-groups-of-data" class="nav-link" data-scroll-target="#identify-groups-of-data"><span class="header-section-number">4.5</span> 4. Identify groups of data</a></li>
  <li><a href="#identify-the-data-series-from-each-subject-to-create-a-spaghetti-plot" id="toc-identify-the-data-series-from-each-subject-to-create-a-spaghetti-plot" class="nav-link" data-scroll-target="#identify-the-data-series-from-each-subject-to-create-a-spaghetti-plot"><span class="header-section-number">4.6</span> 5. Identify the data series from each subject to create a “Spaghetti plot”</a></li>
  <li><a href="#add-labels-titles-axes-labels-and-choose-a-theme-for-the-plot" id="toc-add-labels-titles-axes-labels-and-choose-a-theme-for-the-plot" class="nav-link" data-scroll-target="#add-labels-titles-axes-labels-and-choose-a-theme-for-the-plot"><span class="header-section-number">4.7</span> 6. Add labels (titles, axes labels) and choose a theme for the plot</a></li>
  <li><a href="#split-by-treatment-arm" id="toc-split-by-treatment-arm" class="nav-link" data-scroll-target="#split-by-treatment-arm"><span class="header-section-number">4.8</span> 7. Split by treatment arm</a></li>
  <li><a href="#save-the-plot" id="toc-save-the-plot" class="nav-link" data-scroll-target="#save-the-plot"><span class="header-section-number">4.9</span> 8. Save the plot</a></li>
  <li><a href="#add-a-summary-statistic-e.g.-median" id="toc-add-a-summary-statistic-e.g.-median" class="nav-link" data-scroll-target="#add-a-summary-statistic-e.g.-median"><span class="header-section-number">4.10</span> 9. Add a summary statistic e.g.&nbsp;median</a></li>
  <li><a href="#axis-bounds" id="toc-axis-bounds" class="nav-link" data-scroll-target="#axis-bounds"><span class="header-section-number">4.11</span> 10. Axis bounds</a></li>
  <li><a href="#the-ggplot2-object." id="toc-the-ggplot2-object." class="nav-link" data-scroll-target="#the-ggplot2-object."><span class="header-section-number">4.12</span> 11. The ggplot2 object.</a></li>
  <li><a href="#changing-data" id="toc-changing-data" class="nav-link" data-scroll-target="#changing-data"><span class="header-section-number">4.13</span> 12. Changing data</a></li>
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge"><span class="header-section-number">4.14</span> Challenge</a></li>
  <li><a href="#extra-challenge" id="toc-extra-challenge" class="nav-link" data-scroll-target="#extra-challenge"><span class="header-section-number">4.15</span> Extra challenge</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mini-project 5 - Getting started with {ggplot2}</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mike K Smith </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 16, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="data-source" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="data-source"><span class="header-section-number">4.1</span> Data Source</h2>
<p>For these projects we are using anonymized CDISC datasets, which can be found here: https://github.com/phuse-org/phuse-scripts/tree/master/data/adam/cdisc</p>
<p>In this mini-project we will be using the <code>{ggplot2}</code> package to create data visualizations. {ggplot2} is our preferred package for creating data visualizations as there are a large number of ancillary packages that can be used to annotate and manipulate the created plots.</p>
<p>In this mini-project we’ll be using the <code>ggplot</code> function and defining how data columns map to plot aesthetics using the <code>aes</code> function. We’re also going to be using various functions that define how the data points are going to be displayed in the plot - <code>geom_point</code>, <code>geom_line</code>. The <code>labs</code> function allows you to annotate plots with titles, subtitles, axes labels etc.</p>
</section>
<section id="create-a-dataset" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="create-a-dataset"><span class="header-section-number">4.2</span> 1. Create a dataset</h2>
<p>This dataset is the Analysis Vital Signs from CDISC that was created for training/testing purposes. We’re going to focus on the heart rate measurement in this Mini Project. We are calculating a new variable <code>StudyWeek</code> that defines the week within the Active Treatment Period.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ADVS <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="at">file =</span> <span class="st">"./data/advs.xpt"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>PR <span class="ot">&lt;-</span> ADVS <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PARAMN <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VISITNUM <span class="sc">&gt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StudyWeek =</span> <span class="fu">floor</span>(ADY<span class="sc">/</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="use-basic-ggplot-function" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="use-basic-ggplot-function"><span class="header-section-number">4.3</span> 2. Use basic ggplot function</h2>
<p>The basic <code>ggplot</code> command from the <code>{ggplot2}</code> package creates a blank “canvas” on which to place points, lines, shapes etc.</p>
<p>The <code>data</code> argument is the dataset used for the plot. <code>mapping</code> identifies which columns in the data are used to define aesthetics on the plot, which are passed to the <code>aes( )</code> function. So in this case the x axis is defined by <code>ADY</code> which is the study day of the measurement. The y-axis is the numeric value for the heart rate given in the column <code>AVAL</code>. Note this this statement alone simply defines the attributes of the plot - dataset and column mapping to plot attributes.<br>
<br>
<strong>While learning {ggplot2} we strongly recommend explicitly using the <code>mapping</code></strong> <strong>argument</strong>. This will remind you that you are mapping between column values and attributes on the plot. You will see many people skip naming this argument, but this can lead to confusion and makes it harder to learn what is going on in the <code>{ggplot2}</code> call.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data =</span> PR, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>ADY, <span class="at">y=</span>AVAL)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="add-points-to-the-canvas-created-in-the-previous-step." class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="add-points-to-the-canvas-created-in-the-previous-step."><span class="header-section-number">4.4</span> 3. Add points to the “canvas” created in the previous step.</h2>
<p>To make a scatterplot add ‘+ geom_point()’ to the above statement. NOTE: always put the <code>+</code> sign at the end of a line, not at the start.</p>
<p><strong>NOTE:</strong> The <code>{ggplot2}</code> package was created before the advent of the <code>%&gt;%</code> operator. You can view the <code>+</code> operator within <code>{ggplot2}</code> as being analogous to the <code>%&gt;%</code> pipe. <code>+</code> is <strong>adding</strong> additional layers to the plot. If you are familiar with image editing software like Adobe Photoshop then you’ll know that images within Photoshop can be made up of layers which are edited individually.</p>
<p>By default, the <code>geom_</code> functions will honour the column to aesthetic attributes defined in the <code>ggplot</code> function <strong>but it doesn’t have to.</strong> These <code>geom_</code> functions have a <code>mapping</code> argument of their own to allow you to redefine or change mappings if required.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> PR, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>ADY, <span class="at">y=</span>AVAL)) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="identify-groups-of-data" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="identify-groups-of-data"><span class="header-section-number">4.5</span> 4. Identify groups of data</h2>
<p>There is a <code>group</code> argument to the <code>aes( )</code> function which allows you to define groupings / data series within the dataset. In the plot above, it might be good to show which data corresponds to different treatment arms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> PR, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>ADY, <span class="at">y=</span>AVAL, <span class="at">group =</span> TRTA)) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Huh? That hasn’t done anything?</p>
<p>Well, yes it has. It’s just that you can’t see the change in the graph. You’ve defined the grouping in the data that goes into the graph. But did you want to see different colours or different shapes? If so, then you need to map these to colour or shape attributes in the <code>aes( )</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> PR, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>ADY, <span class="at">y=</span>AVAL, <span class="at">group =</span> TRTA, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">colour =</span> TRTA, <span class="at">shape =</span> TRTA)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Mapping <code>group</code> attributes to column values in the <code>ggplot</code> function i.e.&nbsp;changing attributes for every level of a <code>group</code> variable means that subsequent <code>geom_</code> settings are applied to each level of the <code>group</code> variable.</p>
</section>
<section id="identify-the-data-series-from-each-subject-to-create-a-spaghetti-plot" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="identify-the-data-series-from-each-subject-to-create-a-spaghetti-plot"><span class="header-section-number">4.6</span> 5. Identify the data series from each subject to create a “Spaghetti plot”</h2>
<p>This plot shows that while most subjects have ECG measurements on the same day, there are a few subjects that have ECGs at different times. What the plot does <strong><em>not</em></strong> show is how the points are grouped by individual i.e.&nbsp;each individual is measured multiple times, so how do we show which points are from the same subject?</p>
<p>Before running the chunk below, have a guess what the plot will look like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> PR, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>ADY, <span class="at">y=</span>AVAL)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In Step 4 above, we defined a <code>group</code> mapping to show data for each level of <code>TRTA</code>. We can use exactly the same technique here to show the data for each <strong><em>subject</em></strong>. Add a <code>group</code> attribute within the <code>aes</code> function below to show the “spaghetti plot” that shows the heart rate data series for each subject. Hint: patients are identified using the <code>USUBJID</code> variable. Typically, spaghetti plots use one colour for the lines linking observations from the same subject so there is no need to specify a colour attribute here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> PR <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> PR, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>ADY, <span class="at">y=</span>AVAL, <span class="at">group =</span>  )) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that we’re assigning the <code>{ggplot2}</code> plot to an object called <code>plot1</code>. This is a good idea, since it means we can pick up that object at any point and make modifications to it simply by using the <code>+</code> operator and making changes. <code>ggplot2</code> plot objects can have any attribute changed or added to using the <code>+</code> operator.</p>
</section>
<section id="add-labels-titles-axes-labels-and-choose-a-theme-for-the-plot" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="add-labels-titles-axes-labels-and-choose-a-theme-for-the-plot"><span class="header-section-number">4.7</span> 6. Add labels (titles, axes labels) and choose a theme for the plot</h2>
<p>Change the text in the <code>labs()</code> statement below to make sensible titles and axes labels for the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> plot1 <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot Title"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Plot subtitle"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X-axis label"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Y-axis label"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Plot created on:"</span>,<span class="fu">Sys.Date</span>()))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>plot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You can also choose a theme for the plot from a wide range of <code>{ggplot2}</code> themes. Other themes are available from a variety of <code>{ggplot2}</code> helper packages such as <code>{cowplot}</code>. Try out some different themes using <code>theme_...</code> functions to see which one you like best.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> plot2 <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="split-by-treatment-arm" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="split-by-treatment-arm"><span class="header-section-number">4.8</span> 7. Split by treatment arm</h2>
<p>The next thing we might want to do is to split the above plot (which shows ALL subjects in the trial) by treatment arm. To do this, we want to use a variable within the data to define which data goes in which panel. We do this using the <code>facet_</code> functions. <code>facet_grid</code> splits the data by one or more specified variables and arranges the plots in a grid on the page - one variable defining the rows and (optionally) another variable specifying the columns. <code>facet_wrap</code> takes <strong><em>one</em></strong> variable and creates a new plot for each distinct value of that variable and fills the page with as many plots as it can. Try out both here to see which one works best in this situation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> plot3 <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="st">"TRTA"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plot4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now that you know how, you can employ ANY variable to split the plot e.g.&nbsp;SEX, PERIOD, …</p>
</section>
<section id="save-the-plot" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="save-the-plot"><span class="header-section-number">4.9</span> 8. Save the plot</h2>
<p>Once you’re ready to save the plot, you can use the <code>ggsave</code> function to render and externalise the plot in whatever format you need. It’s a good idea to also save the final plot object using <code>saveRDS</code> as you can then read this object into R and make changes later.</p>
<p>NOTE: If you are saving from this .rmd file then the plots and output object will be saved wherever this .rmd file is located.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plot4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"myPlot.png"</span>, <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">width =</span> <span class="dv">192</span>, <span class="at">height =</span> <span class="dv">108</span>, <span class="at">units =</span> <span class="st">"mm"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="at">object =</span> plot4, <span class="at">file =</span> <span class="st">"savedPlot.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-a-summary-statistic-e.g.-median" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="add-a-summary-statistic-e.g.-median"><span class="header-section-number">4.10</span> 9. Add a summary statistic e.g.&nbsp;median</h2>
<p>The spaghetti plot may be useful, but it would be good to show the median heart rate so we can get a feel for how this changes for each treatment arm.</p>
<p>We can do this using the built in {ggplot2} functions <code>stat_summary</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plot3 <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">fun =</span> median, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing non-finite outside the scale range
(`stat_summary()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the <code>plot3</code> object, we have a grouping attribute in the <code>ggplot</code> function call mapped to <code>USUBJID</code> from the dataset. By specifying this <code>group</code> aesthetic we are telling R that any <code>geom_</code> and <code>stat_</code> functions should use the same grouping. So that means that the <code>stat_summary</code> is attempting to display the median values at each time point <strong><em>for every subject.</em></strong> Which is probably NOT what we actually want, since there is only one observation per subject per time point.</p>
<p>So how do we go back to one showing medians calculate across ALL subjects?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plot3 <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">group =</span> <span class="cn">NULL</span>), <span class="at">fn =</span> median, <span class="at">colour =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in stat_summary(mapping = aes(group = NULL), fn = median, colour =
"red"): Ignoring unknown parameters: `fn`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing non-finite outside the scale range
(`stat_summary()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Not all subjects have been assessed for vital signs on the same day of the treatment period. Let’s look at the same plot as above, but using the calculated variable <code>StudyWeek</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> PR, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>StudyWeek, <span class="at">y=</span>AVAL)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see that subjects have measurements on weeks between 0-30, and then a few individuals having measurements at week 40. Let’s filter down to the weeks 0, 5, 10, 15, 20, 25, 30 before applying the <code>stat_summary</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dataWeeks <span class="ot">&lt;-</span> PR <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(StudyWeek <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ADY =</span> StudyWeek <span class="sc">*</span> <span class="dv">7</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>dataWeeks <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> StudyWeek, <span class="at">y =</span> AVAL)) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">group =</span> <span class="cn">NULL</span>), </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun =</span> median, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_summary()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values or values outside the scale range
(`geom_segment()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now we might want to superimpose these medians onto the spaghetti plots above. But observe that the <code>StudyWeek</code> variable needs to be rescaled to show “days” so that it can be plotted on the same x-axis scale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plot3 <span class="sc">+</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">data =</span> dataWeeks,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ADY,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">group =</span> <span class="cn">NULL</span>), </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun =</span> median, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_summary()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values or values outside the scale range
(`geom_segment()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot illustrates how we can add a layer with new data (here, just the original data selecting the weeks we are interested in).</p>
</section>
<section id="axis-bounds" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="axis-bounds"><span class="header-section-number">4.11</span> 10. Axis bounds</h2>
<p>Sometimes we want to limit the plot axes to “zoom in” on an area of the plot where most of the data are. If you specify <code>scale_y_continuous(limits=c(50, 120))</code> then points outside the range 50 - 120 are <strong>removed</strong>. If you specify <code>coord_cartesian(ylim=c(50, 120))</code> then you are effectively <strong>zooming in</strong> to a particular range. Any values outside that range will still exist and influence regression lines / smooths / medians, but are not shown. Typically we will want to “zoom in” rather than crop and eliminate observations outside of the range.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plot4 <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">120</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-ggplot2-object." class="level2" data-number="4.12">
<h2 data-number="4.12" class="anchored" data-anchor-id="the-ggplot2-object."><span class="header-section-number">4.12</span> 11. The ggplot2 object.</h2>
<p>Let’s look at the <code>plot4</code> object in more detail. You can examine it using the Environment tab in RStudio IDE. Click on the magnifying glass to the right of the object. <code>plot4</code> is an R list with type <code>ggplot</code>. Within it you’ll see it elements such as the data, layers, scales, mapping, theme, coordinates, facet, labels. This means that <strong>at any time</strong> you can extract information from a <code>ggplot</code> object and use it.</p>
<p>To see the elements of a list in the RStudio IDE, go to the Environment tab and then click on the blue arrow to the left of the <code>plot4</code> object. This will show a huge amount of information about the plot - these are the plot attributes, which are contained in an R <code>list</code> format. To access an element of a list, you can use the <code>&lt;objectName&gt;$&lt;listItemName&gt;</code> syntax. Let’s look at the <code>mapping</code> element of the <code>plot4</code> object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plot4<span class="sc">$</span>mapping</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Aesthetic mapping: 
* `x` -&gt; `ADY`
* `y` -&gt; `AVAL`</code></pre>
</div>
</div>
<p>From this information, you’ll see that the <code>x</code> and <code>y</code> attributes are being mapped to variable names <code>ADY</code> and <code>PARAM</code>. What we might want to do is to extract the variable <strong><em>names</em></strong> in these attributes and use them to determine labels for the plot.<br>
<br>
In programming, we sometimes want to use a variable name to tell us which column contains values, and sometimes we just want to use the name of that variable. In this case, because we want to just use the name, we need to tell R to turn the variable “pointer” to a character string. We do this using the <code>quo_name</code> function. We’ll look more at how to refer to variables and use them in functions in a later Mini-Project.</p>
<p>In the code below we have created a function called <code>uniqueVal</code>. This function is going to be used to extract information from dataset variables that can be used in axes labels. Again, in a future Mini-Project we’ll look in more depth at creating your own functions. For now, just be aware that we’ve written a function to find the unique value of a given variable in the dataset. We have a little defensive programming that checks that the variable doesn’t contain more than one unique value.</p>
<p>By approaching the problem in this way, we avoid having to “hard code” axes labels and can more easily reuse code for different cases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>xLab <span class="ot">&lt;-</span> <span class="fu">quo_name</span>(plot4<span class="sc">$</span>mapping<span class="sc">$</span>x)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>yLab <span class="ot">&lt;-</span> <span class="fu">quo_name</span>(plot4<span class="sc">$</span>mapping<span class="sc">$</span>y)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>groupLab <span class="ot">&lt;-</span> <span class="fu">quo_name</span>(plot4<span class="sc">$</span>mapping<span class="sc">$</span>group)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>uniqueVal <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">unique</span>(x))<span class="sc">&gt;</span><span class="dv">1</span>) <span class="fu">simpleWarning</span>(<span class="fu">paste0</span>(<span class="st">"More than one value in column:"</span>,x))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(x)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span> <span class="fu">uniqueVal</span>(plot4<span class="sc">$</span>data<span class="sc">$</span>STUDYID)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>measure <span class="ot">&lt;-</span> <span class="fu">uniqueVal</span>(plot4<span class="sc">$</span>data<span class="sc">$</span>PARAM)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>xLab <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(xLab <span class="sc">==</span> <span class="st">"ADY"</span>, <span class="st">"Analysis Relative Day"</span>, xLab)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>groupLab <span class="ot">&lt;-</span> <span class="fu">case_when</span>(groupLab <span class="sc">==</span> <span class="st">"USUBJID"</span> <span class="sc">~</span> <span class="st">"Subject"</span>, </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                      groupLab <span class="sc">==</span> <span class="st">"TRTA"</span> <span class="sc">~</span> <span class="st">"Treatment"</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>                      <span class="cn">TRUE</span> <span class="sc">~</span> groupLab)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>plot4 <span class="sc">+</span> </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Study {study}"</span>),</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Plot of {measure} by {groupLab}"</span>),</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> xLab,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{measure}"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="changing-data" class="level2" data-number="4.13">
<h2 data-number="4.13" class="anchored" data-anchor-id="changing-data"><span class="header-section-number">4.13</span> 12. Changing data</h2>
<p>Now for the clever bit. <code>{ggplot2}</code> allows you to change the dataset in a plot, and inheriting attributes from the previous plot. You do this using the <code>%+%</code> command. On the left of the <code>%+%</code> should be an object of type <code>ggplot</code> and on the right should be a dataset object.</p>
<p>And if you use the code above to “guess” the labels for the plot from information within the data, then the labels automagically update themselves. Ideally, you might want to make the label guessing code into a function that takes the plot object as an input, but we’ll come to functions shortly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>SysBP <span class="ot">&lt;-</span> ADVS  <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PARAMN <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VISITNUM <span class="sc">&gt;</span> <span class="dv">3</span>) </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>SysBP_plot <span class="ot">&lt;-</span> plot4 <span class="sc">%+%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  SysBP</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>xLab <span class="ot">&lt;-</span> <span class="fu">quo_name</span>(SysBP_plot<span class="sc">$</span>mapping<span class="sc">$</span>x)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>yLab <span class="ot">&lt;-</span> <span class="fu">quo_name</span>(SysBP_plot<span class="sc">$</span>mapping<span class="sc">$</span>y)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>groupLab <span class="ot">&lt;-</span> <span class="fu">quo_name</span>(SysBP_plot<span class="sc">$</span>mapping<span class="sc">$</span>group)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span> <span class="fu">uniqueVal</span>(SysBP_plot<span class="sc">$</span>data<span class="sc">$</span>STUDYID)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>measure <span class="ot">&lt;-</span> <span class="fu">uniqueVal</span>(SysBP_plot<span class="sc">$</span>data<span class="sc">$</span>PARAM)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>xLab <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(xLab <span class="sc">==</span> <span class="st">"ADY"</span>, <span class="st">"Analysis Relative Day"</span>, xLab)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>groupLab <span class="ot">&lt;-</span> <span class="fu">case_when</span>(groupLab <span class="sc">==</span> <span class="st">"USUBJID"</span> <span class="sc">~</span> <span class="st">"Subject"</span>, </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                      groupLab <span class="sc">==</span> <span class="st">"TRTA"</span> <span class="sc">~</span> <span class="st">"Treatment"</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                      <span class="cn">TRUE</span> <span class="sc">~</span> groupLab)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>SysBP_plot <span class="sc">+</span> </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Study {study}"</span>),</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Plot of {measure} by {groupLab}"</span>),</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> xLab,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{measure}"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MiniProject5_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="challenge" class="level2" data-number="4.14">
<h2 data-number="4.14" class="anchored" data-anchor-id="challenge"><span class="header-section-number">4.14</span> Challenge</h2>
<p>Do the same for Diastolic BP and Temperature. Ensure that the axes labels match the type of data used.<br>
Update <code>plot4</code> for the new endpoint.</p>
</section>
<section id="extra-challenge" class="level2" data-number="4.15">
<h2 data-number="4.15" class="anchored" data-anchor-id="extra-challenge"><span class="header-section-number">4.15</span> Extra challenge</h2>
<p>Read in vital signs data from another study which uses the <code>VS</code> or <code>ADVS</code> dataset standards. What code needs to change when you produce Pulse Rate plot for the new dataset (compared to the Pulse Rate plot which uses data values to determine labels)?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.3 (2024-02-29)
 os       macOS 26.0
 system   aarch64, darwin20.0.0
 ui       unknown
 language (EN)
 collate  C.UTF-8
 ctype    C.UTF-8
 tz       Asia/Seoul
 date     2025-07-09
 pandoc   3.6.3 @ /Users/fkt/Downloads/repo/pharma-hands-on-exercises/.pixi/envs/default/bin/ (via rmarkdown)
 quarto   1.7.32 @ /Users/fkt/Downloads/repo/pharma-hands-on-exercises/.pixi/envs/default/bin/quarto

─ Packages ───────────────────────────────────────────────────────────────────
 package      * version date (UTC) lib source
 cli            3.6.5   2025-04-23 [1] CRAN (R 4.3.3)
 digest         0.6.37  2024-08-19 [1] CRAN (R 4.3.3)
 dplyr        * 1.1.4   2023-11-17 [1] CRAN (R 4.3.3)
 evaluate       1.0.4   2025-06-18 [1] CRAN (R 4.3.3)
 farver         2.1.2   2024-05-13 [1] CRAN (R 4.3.3)
 fastmap        1.2.0   2024-05-15 [1] CRAN (R 4.3.3)
 forcats      * 1.0.0   2023-01-29 [1] CRAN (R 4.3.3)
 generics       0.1.4   2025-05-09 [1] CRAN (R 4.3.3)
 ggplot2      * 3.5.2   2025-04-09 [1] CRAN (R 4.3.3)
 glue         * 1.8.0   2024-09-30 [1] CRAN (R 4.3.3)
 gtable         0.3.6   2024-10-25 [1] CRAN (R 4.3.3)
 haven          2.5.4   2023-11-30 [1] CRAN (R 4.3.3)
 hms            1.1.3   2023-03-21 [1] CRAN (R 4.3.3)
 htmltools      0.5.8.1 2024-04-04 [1] CRAN (R 4.3.3)
 htmlwidgets    1.6.4   2023-12-06 [1] CRAN (R 4.3.3)
 jsonlite       2.0.0   2025-03-27 [1] CRAN (R 4.3.3)
 knitr          1.50    2025-03-16 [1] CRAN (R 4.3.3)
 labeling       0.4.3   2023-08-29 [1] CRAN (R 4.3.3)
 lifecycle      1.0.4   2023-11-07 [1] CRAN (R 4.3.3)
 lubridate    * 1.9.4   2024-12-08 [1] CRAN (R 4.3.3)
 magrittr       2.0.3   2022-03-30 [1] CRAN (R 4.3.3)
 pillar         1.11.0  2025-07-04 [1] CRAN (R 4.3.3)
 pkgconfig      2.0.3   2019-09-22 [1] CRAN (R 4.3.3)
 purrr        * 1.0.4   2025-02-05 [1] CRAN (R 4.3.3)
 R.methodsS3    1.8.2   2022-06-13 [1] CRAN (R 4.3.3)
 R.oo           1.27.1  2025-05-02 [1] CRAN (R 4.3.3)
 R.utils        2.13.0  2025-02-24 [1] CRAN (R 4.3.3)
 R6             2.6.1   2025-02-15 [1] CRAN (R 4.3.3)
 ragg           1.4.0   2025-04-10 [1] CRAN (R 4.3.3)
 RColorBrewer   1.1-3   2022-04-03 [1] CRAN (R 4.3.3)
 readr        * 2.1.5   2024-01-10 [1] CRAN (R 4.3.3)
 rio          * 1.2.3   2024-09-25 [1] CRAN (R 4.3.3)
 rlang          1.1.6   2025-04-11 [1] CRAN (R 4.3.3)
 rmarkdown      2.29    2024-11-04 [1] CRAN (R 4.3.3)
 scales         1.4.0   2025-04-24 [1] CRAN (R 4.3.3)
 sessioninfo    1.2.3   2025-02-05 [1] CRAN (R 4.3.3)
 stringi        1.8.4   2024-05-06 [1] CRAN (R 4.3.3)
 stringr      * 1.5.1   2023-11-14 [1] CRAN (R 4.3.3)
 systemfonts    1.2.3   2025-04-30 [1] CRAN (R 4.3.3)
 textshaping    0.4.0   2024-05-24 [1] CRAN (R 4.3.3)
 tibble       * 3.3.0   2025-06-08 [1] CRAN (R 4.3.3)
 tidyr        * 1.3.1   2024-01-24 [1] CRAN (R 4.3.3)
 tidyselect     1.2.1   2024-03-11 [1] CRAN (R 4.3.3)
 tidyverse    * 2.0.0   2023-02-22 [1] CRAN (R 4.3.3)
 timechange     0.3.0   2024-01-18 [1] CRAN (R 4.3.3)
 tzdb           0.5.0   2025-03-15 [1] CRAN (R 4.3.3)
 vctrs          0.6.5   2023-12-01 [1] CRAN (R 4.3.3)
 withr          3.0.2   2024-10-28 [1] CRAN (R 4.3.3)
 xfun           0.52    2025-04-02 [1] CRAN (R 4.3.3)
 yaml           2.3.10  2024-07-26 [1] CRAN (R 4.3.3)

 [1] /Users/fkt/Downloads/repo/pharma-hands-on-exercises/.pixi/envs/default/lib/R/library
 * ── Packages attached to the search path.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./MiniProject4.html" class="pagination-link" aria-label="Mini-project 4 - Creating summary table data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Mini-project 4 - Creating summary table data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./MiniProject6.html" class="pagination-link" aria-label="Mini-project 6 - {ggplot2} extensions">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mini-project 6 - {ggplot2} extensions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>